import{G as I,H as M,W as R,X as T,j as s,B as $,Y as z,L as g,a9 as C,n as h,M as p,S as H,T as L,aa as W,h as c,p as j,v as q,w as A,u as b,e as f,a6 as U,$ as V,F as G,ab as Q,m as X,a7 as Y}from"./chunk-6A3eeJze.js";import"./chunk-XkqPTsGq.js";import{P as J}from"./chunk-Dx8xnCDx.js";import{s as d}from"./chunk-C1UfUYGV.js";import{c as m,p as k,b as K}from"./chunk-fKBaBdH9.js";import{N as O}from"./chunk-BtshWgSu.js";import{u as Z,F as ee}from"./chunk-0s_YbkLR.js";import{s as B}from"./chunk-D_TSPZfq.js";import{I as se}from"./chunk-D4bDxRiv.js";var v={root:"m_18320242","skeleton-fade":"m_299c329c"};const re={visible:!0,animate:!0},ae=T((e,{width:r,height:a,radius:o,circle:t})=>({root:{"--skeleton-height":g(a),"--skeleton-width":t?g(a):g(r),"--skeleton-radius":t?"1000px":o===void 0?void 0:z(o)}})),y=I((e,r)=>{const a=M("Skeleton",re,e),{classNames:o,className:t,style:l,styles:u,unstyled:n,vars:i,width:me,height:ue,circle:fe,visible:w,radius:ge,animate:S,mod:N,...E}=a,F=R({name:"Skeleton",classes:v,props:a,className:t,style:l,classNames:o,styles:u,unstyled:n,vars:i,varsResolver:ae});return s.jsx($,{ref:r,...F("root"),mod:[{visible:w,animate:S},N],...E})});y.classes=v;y.displayName="@mantine/core/Skeleton";function oe(e){var r,a;C.unit(e)?r=e:{source:r,reset:a}=e;var o=h(!0,{name:"$canTrigger",sid:"ys2jl0"}),t=p({and:[{source:r,filter:o}],or:{name:"trigger",sid:"e3xto3"}});return o.on(t,()=>!1),a&&o.reset(a),t}const te=({regularPrice:e,promocodePrice:r})=>s.jsxs(H,{className:d.wrapper,children:[s.jsx(L,{className:d.title,order:2,children:"Полный отчет по вашему типу личности"}),s.jsx(y,{className:d.skeleton,hidden:!!e,radius:"sm"}),s.jsxs(W,{gap:"lg",children:[s.jsxs(c,{hidden:!e,className:d.price,td:r?"line-through":"",c:r?"dark.0":"dark.7",children:[e," ",s.jsx(c,{className:d.price,span:!0,ff:"system-ui",children:"₽"})]}),s.jsxs(c,{hidden:!r,className:d.price,c:"violet.8",children:[r," ",s.jsx(c,{className:d.price,span:!0,ff:"system-ui",children:"₽"})]})]})]}),ne=e=>{e.target.value=String(e.target.value).toUpperCase()};function ie(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}function ce(e){return ie(e)&&"data"in e&&"message"in e}const x=j({name:"applyPromocodeClicked",sid:"-qysmia"}),P=h("",{name:"$promocodeErrorMessage",sid:"462iax"}).on(x,()=>""),D=h(!1,{name:"$showSuccessPromoMessage",sid:"zdt2a3"}),_=j({},{name:"reportPurchased",sid:"qbhkfn"}),le=q(async e=>{window.open(e,"_self")},{name:"openTransactionPaywallFx",sid:"-rwu2tu"});p({and:[{clock:x,target:m.start}],or:{sid:"-9rqp80"}});p({and:[{clock:m.finished.failure,fn:({error:e})=>ce(e)?e.data.message:"",target:P}],or:{sid:"-9dg1sm"}});p({and:[{clock:m.finished.failure,fn:()=>!1,target:D}],or:{sid:"-8yllrv"}});p({and:[{clock:m.finished.success,fn:()=>!0,target:D}],or:{sid:"-8vau7p"}});p({and:[{clock:_,target:k.start}],or:{sid:"-8gge6y"}});p({and:[{source:A({sid:"-1ucvjy",fn:()=>oe(k.finished.success),name:"source",method:"once"}),fn:({result:e})=>e.confirmation_url,target:le}],or:{sid:"-8dpf85"}});const de=()=>{const{routeParams:{surveyId:e,type:r}}=b(),a=f(_),o=Z({mode:"controlled",initialValues:{email:"",mbti_type:e?"":r,promo_code:"",survey_result:e??""},validate:{email:n=>/^\S+@\S+$/.test(n)?null:"Неправильный email"}}),t={radius:"xs",name:"email",withAsterisk:!0,key:o.key("email"),label:"Электронная почта",placeholder:"name@mail.ru",...o.getInputProps("email")},l={radius:"xs",name:"promo_code",key:o.key("promo_code"),placeholder:"Введите промокод",...o.getInputProps("promo_code")},u=o.onSubmit(n=>{const i={...n};n.mbti_type||(i.mbti_type=r),e&&delete i.mbti_type,e||delete i.survey_result,i.promo_code||delete i.promo_code,a(i)});return{form:o,onSubmit:u,emailProps:t,promocodeProps:l}},pe=()=>{const{pending:e}=f(m),{onSubmit:r,promocodeProps:a,emailProps:o,form:t}=de(),{applyPromoHandler:l,promocodeError:u,showSuccessMessage:n}=f({applyPromoHandler:x,promocodeError:P,showSuccessMessage:D});return s.jsxs(ee,{onSubmit:r,children:[s.jsx(U,{...o}),s.jsxs(V,{bg:"gray.0",radius:"xs",p:"md",px:"sm",children:[s.jsx(c,{className:B.promocodeLabel,children:"У меня есть промокод"}),s.jsxs(G,{className:B.promocodeWrapper,children:[s.jsx(Q,{...a,disabled:e,error:u,onInput:ne,"data-success":n,description:n?"Промокод применен":"",inputWrapperOrder:["label","input","description","error"]}),s.jsx(X,{fullWidth:!0,c:"dark.7",radius:"xs",color:"dark.7",variant:"outline",disabled:e,loading:e,onClick:()=>l(t.values.promo_code.toUpperCase()),children:"Применить"})]})]}),s.jsx(Y,{disabled:e,radius:"xs",size:"md",type:"submit",children:"Перейти к оплате"}),s.jsxs(c,{fz:12,ta:"center",mb:12,children:["Нажимая на кнопку, вы подтверждаете свое согласие на сбор, хранение и использование ваших персональных данных согласно"," ",s.jsx(c,{fz:12,c:"blue.7",component:"a",href:"https://storage.yandexcloud.net/cognitive-lab-public/%D0%9F%D0%BE%D0%BB%D0%B8%D1%82%D0%B8%D0%BA%D0%B0%20%D0%BA%D0%BE%D0%BD%D1%84%D0%B8%D0%B4%D0%B5%D0%BD%D1%86%D0%B8%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D1%81%D1%82%D0%B8.pdf",children:"Политике конфиденциальности"})," ","и принимаете условия"," ",s.jsx(c,{fz:12,c:"blue.7",component:"a",href:"https://storage.yandexcloud.net/cognitive-lab-public/%D0%94%D0%BE%D0%B3%D0%BE%D0%B2%D0%BE%D1%80%20%D0%BE%D1%84%D0%B5%D1%80%D1%82%D1%8B.pdf",children:"Публичной оферты"})]})]})},Pe=()=>{const{data:e,pending:r}=f(K),{data:a}=f(m),{routeParams:{surveyId:o}}=b();if(!e&&r)return s.jsx(J,{});if(!e)return null;const t=o?e.regular_price:e.skip_survey_price,l=o?a==null?void 0:a.regular_price.final:a==null?void 0:a.skip_survey_price.final;return s.jsxs(se,{image:"/images/paywall-man_large.webp",children:[s.jsx(te,{regularPrice:t,promocodePrice:l}),s.jsx(pe,{}),s.jsx(O,{})]})};export{Pe as P};
