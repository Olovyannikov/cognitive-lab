import{x as m,O as u,y as h,z as x,al as b,r as j,j as s,t as y,a0 as _,I as N,S as k,T as g,B as S,k as T,a as v,E as w,J as p,K as z,L as B,M as l,am as $,s as Q}from"./chunk-BuKCrowM.js";import{l as C}from"./chunk-BycDUK8L.js";import{M as O}from"./chunk-BrHLm4Ew.js";import{s as r}from"./chunk-9Of7RetC.js";import{G as D}from"./chunk-Br_N7DbV.js";import{C as F}from"./chunk-BZQ96mvF.js";import{B as I}from"./chunk-Bjam_Udm.js";import"./chunk-BkmPTwIQ.js";const i=m({sid:"8wrxdv",fn:()=>u({initialData:{},effect:h(e=>({url:x.BLOG_POSTS,params:{post_type:"post",page_size:Number(e.page_size),...e}})),mapData:e=>{var n;if(!e.result)return{};const a=(n=e.result)==null?void 0:n.payload.toSorted((o,c)=>Number(c.pinned)-Number(o.pinned));return{...e.result,payload:a}}}),name:"getBlogPostsQuery",method:"createQuery"}),U=m({sid:"-1szoee",fn:()=>u({initialData:{},effect:h(e=>({url:x.BLOG_POSTS,params:{post_type:"post",page_size:Number(e.page_size),show_on_main:!0,...e}})),mapData:e=>{var n;if(!e.result)return{};const a=(n=e.result)==null?void 0:n.payload.toSorted((o,c)=>Number(c.pinned)-Number(o.pinned)).map(o=>({...o,updated_at:new Date(o.updated_at).toLocaleDateString("ru-RU")}));return{...e.result,payload:a}}}),name:"getAllBlogPostsQuery",method:"createQuery"}),V=m({sid:"-ck1tj0",fn:()=>u({effect:h(e=>({url:x.BLOG_POST_BY_ID(e)}))}),name:"getBlogPostByIdQuery",method:"createQuery"});m({sid:"r1uq9s",fn:()=>b(i),name:"none",method:"cache"});const M=j.memo(({post:e})=>s.jsx(D.Col,{span:{base:12,lg:e.pinned?12:4},className:y(e.pinned&&r.pinned),children:s.jsx(F,{h:"100%",withBorder:!0,component:"a",href:`/blog/${e.id}`,children:s.jsxs(_,{className:y(r.card,e.pinned&&r.row),gap:"md",children:[s.jsx(N,{className:r.image,fit:"cover",radius:"xs",src:e.thumbnail_image,alt:e.title}),s.jsxs(k,{className:r.preview,justify:"center",children:[s.jsx(g,{className:r.title,children:e.title}),s.jsx(S,{className:r.text,children:s.jsx(O,{options:{overrides:{h1:a=>s.jsx(g,{order:1,className:r.title,children:a.children}),h2:a=>s.jsx(g,{order:2,className:r.title,children:a.children}),p:a=>s.jsx(T,{className:r.text,children:a.children}),blockquote:a=>s.jsx(I,{mb:"md",py:"sm",px:"md",color:"violet.9",bg:"transparent",icon:null,children:a.children}),a:a=>s.jsx(s.Fragment,{children:a.children})}},children:e.body.data})}),s.jsx(v,{variant:"subtle",rightSection:s.jsx(C,{}),className:r.more,children:"Читать"})]})]})})}));M.displayName="BlogPostCard";const Y=w(()=>{const e=p(5,{name:"$pageSize",sid:"2aag3l"}),a=p(1,{name:"$currentPage",sid:"ytwjf1"}),n=p([],{name:"$blogPosts",sid:"-vcd1gb"}),o=z({name:"pageChanged",sid:"pmok7e"}),c=B(()=>window.scrollTo(0,0),{name:"scrollToTopFx",sid:"ajbrrh"});l({and:[{clock:i.finished.success,fn:({result:t})=>t.payload,target:n}],or:{sid:"-vqntl4"}}),l({and:[{clock:o,target:a}],or:{sid:"-vbtdkd"}}),l({and:[{clock:o,target:c}],or:{sid:"-v92elk"}}),l({and:[{clock:e,filter:i.$data.map(t=>{var d;return((d=t==null?void 0:t.payload)==null?void 0:d.length)<1}),fn:t=>({page:1,page_size:t}),target:i.refresh}],or:{sid:"-uurr66"}}),l({and:[{clock:a,source:{page_size:e},fn:({page_size:t},d)=>({page:d,page_size:t}),target:i.refresh}],or:{sid:"-urgzm0"}});const P=$(i.finished.success.map(t=>t.result.total_pages),1,{name:"$totalPages",sid:"4862x6"}),f=B(async()=>{await Q("/blog")},{name:"redirectToMainBlogPostPageFx",sid:"oz6xl2"});return l({and:[{clock:i.finished.failure,target:f}],or:{sid:"-tuhc0c"}}),{$currentPage:a,$pageSize:e,pageChanged:o,$totalPages:P,redirectToMainBlogPostPageFx:f,$blogPosts:n}});export{Y as B,M as a,V as b,U as c,i as g};
