import{X as g,aC as b,bt as Q,bu as T,bv as j,w as p,O as A,k as H,aV as S,aW as E,H as V,F as q,I as m,J as P,aX as x,s as d}from"./chunk-HySlhcd_.js";import"./chunk-CMKbZFsA.js";import{i as N}from"./chunk-DGI3hcLu.js";var R=Array.isArray;function O(t){return function(a){const{stores:s,events:r,data:u,functions:o}=$(a.bind),f=$(a.hooks||{});return g.forwardRef((e,n)=>{const l=t.useUnit(s,a.useUnitConfig),i=t.useUnit(r,a.useUnitConfig),h=U(o),w={};n&&(w.ref=n);const y=Object.assign(w,l,i,u,h,e),F=t.useUnit(f.events,a.useUnitConfig),C=U(f.functions);return g.useEffect(()=>{const v=Object.assign({},C,F);return v.mounted&&v.mounted(y),()=>{v.unmounted&&v.unmounted(y)}},[F,C]),g.createElement(a.view,y)})}}function $(t){const c={},a={},s={},r={};for(const u in t){const o=t[u];b.event(o)||b.effect(o)?c[u]=o:b.store(o)?a[u]=o:typeof o=="function"?r[u]=o:s[u]=o}return{events:c,stores:a,data:s,functions:r}}function U(t){const c=Q();return g.useMemo(()=>{const a={};for(const s in t){const r=t[s];a[s]=T(r,{scope:c||void 0,safe:!0})}return a},[c,t])}const M=()=>null;function _(t){const c=O(t);return function(s){let r,u,o;"if"in s?(r=s.if.map(n=>n?"then":"else"),u={then:s.then,else:s.else},o=M):(r=s.source,u=s.cases,o=s.default??M);function f(n){const l=t.useUnit(r,s.useUnitConfig),i=u[l]??o;return g.createElement(i,n)}const e=s.bind??{};return c({bind:e,view:f,hooks:s.hooks,useUnitConfig:s.useUnitConfig})}}const X=O(j),B=_(j),k=p({sid:"-iugphm",fn:()=>A({effect:H(()=>({url:"/surveys/questions"}))}),name:"getQuestionsQuery",method:"createQuery"}),J=p({sid:"-ee19bn",fn:()=>S({effect:E(t=>({url:"/surveys/answers/submit",method:V.POST,body:t}))}),name:"submitAnswersMutation",method:"createMutation"}),W=q(()=>{const t=m(1,{name:"$currentPage",sid:"-ro4v45"}),c=m(0,{name:"$currentProgress",sid:"hhhl88"}),a=m(null,{name:"$currentQuestion",sid:"-nkasqq"}),s=m(null,{name:"$currentValue",sid:"-o0im1t"}),r=m({answers:[]},{name:"$scaleForm",sid:"sjuosy"}),u=P({name:"scaleFormFieldChanged",sid:"cmq463"}),o=P({name:"formPageChanged",sid:"-11v8w4"}),f=p({sid:"-gydwjl",fn:()=>x(u,250),name:"delayedFormFieldChanged",method:"delay"});return d({and:[{clock:[t,k.$data],source:{page:t,questions:k.$data},fn:({page:e,questions:n})=>n?n[e-1]:null,target:a}],or:{sid:"sjbbmu"}}),d({and:[{clock:u,source:r,fn:(e,n)=>(e.answers[n.index]=n,{...e}),target:r}],or:{sid:"t20bt4"}}),d({and:[{clock:f,source:t,filter:(e,n)=>!(n.isMultiple||n.isSingle),fn:e=>e+1,target:o}],or:{sid:"tj1y7b"}}),d({and:[{clock:u,source:{form:r,page:t},filter:(e,n)=>!(n.isMultiple||n.isSingle),fn:({form:e,page:n})=>{const l=n-1;return e.answers&&e.answers.length>0&&"value"in e.answers[l].answer&&e.answers[l].answer.value?e.answers[l].answer.value:null},target:s}],or:{sid:"tyzzes"}}),d({and:[{clock:[r,o],source:{form:r,page:t},fn:({form:{answers:e},page:n},l)=>{var h;const i=(N(l)?l:n)-1;return(h=e[i])!=null&&h.answer?e&&e[i].answer&&R(e[i].answer)||e&&e.length>0&&e[i].isSingle?e[i].answer:e&&e.length>0&&"value"in e[i].answer?e[i].answer.value:null:null},target:s}],or:{sid:"uwjflt"}}),d({and:[{clock:o,fn:e=>(window.scrollTo(0,0),e),target:t}],or:{sid:"eus4mk"}}),d({and:[{clock:r,source:{questions:k.$data,form:r},fn:({questions:e,form:{answers:n}})=>Number((n.length/((e==null?void 0:e.length)??0)*100).toFixed(0)),target:c}],or:{sid:"fb9yfe"}}),{$currentPage:t,$currentProgress:c,$currentQuestion:a,$currentValue:s,$scaleForm:r,scaleFormFieldChanged:u,formPageChanged:o}});export{W as T,k as g,R as i,X as r,J as s,B as v};
