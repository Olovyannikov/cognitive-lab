import{z as m,O as u,E as h,F as x,an as j,r as b,j as a,t as y,a2 as _,I as N,S as w,T as g,B as S,k as T,a as k,J as v,L as z,ao as p,N as Q,Q as B,M as d,s as $}from"./chunk-Bxc84sEY.js";import{l as C}from"./chunk-B3cfY-Kt.js";import{M as F}from"./chunk-xv24A_0W.js";import{s as r}from"./chunk-9Of7RetC.js";import{G as O}from"./chunk-C-fEYrnB.js";import{C as D}from"./chunk-DfiZfHEx.js";import{B as q}from"./chunk-COwbs_Xw.js";import"./chunk-sJPAJ1F0.js";const i=m({sid:"8wrxdv",fn:()=>u({initialData:{},effect:h(e=>({url:x.BLOG_POSTS,params:{post_type:"post",page_size:Number(e.page_size),...e}})),mapData:e=>{var o;if(!e.result)return{};const s=(o=e.result)==null?void 0:o.payload.toSorted((n,l)=>Number(l.pinned)-Number(n.pinned));return{...e.result,payload:s}}}),name:"getBlogPostsQuery",method:"createQuery"}),V=m({sid:"-1szoee",fn:()=>u({initialData:{},effect:h(e=>({url:x.BLOG_POSTS,params:{post_type:"post",page_size:Number(e.page_size),show_on_main:!0,...e}})),mapData:e=>{var o;if(!e.result)return{};const s=(o=e.result)==null?void 0:o.payload.toSorted((n,l)=>Number(l.pinned)-Number(n.pinned)).map(n=>({...n,updated_at:new Date(n.updated_at).toLocaleDateString("ru-RU")}));return{...e.result,payload:s}}}),name:"getAllBlogPostsQuery",method:"createQuery"}),Y=m({sid:"-ck1tj0",fn:()=>u({effect:h(e=>({url:x.BLOG_POST_BY_ID(e)}))}),name:"getBlogPostByIdQuery",method:"createQuery"});m({sid:"r1uq9s",fn:()=>j(i),name:"none",method:"cache"});const I=b.memo(({post:e})=>a.jsx(O.Col,{span:{base:12,lg:e.pinned?12:4},className:y(e.pinned&&r.pinned),children:a.jsx(D,{h:"100%",withBorder:!0,component:"a",href:`/blog/${e.id}`,children:a.jsxs(_,{className:y(r.card,e.pinned&&r.row),gap:"md",children:[a.jsx(N,{className:r.image,fit:"cover",radius:"xs",src:e.thumbnail_image,alt:e.title}),a.jsxs(w,{className:r.preview,justify:"center",children:[a.jsx(g,{className:r.title,children:e.title}),a.jsx(S,{className:r.text,children:a.jsx(F,{options:{overrides:{h1:s=>a.jsx(g,{order:1,className:r.title,children:s.children}),h2:s=>a.jsx(g,{order:2,className:r.title,children:s.children}),p:s=>a.jsx(T,{className:r.text,children:s.children}),blockquote:s=>a.jsx(q,{mb:"md",py:"sm",px:"md",color:"violet.9",bg:"transparent",icon:null,children:s.children}),a:s=>a.jsx(a.Fragment,{children:s.children})}},children:e.body.data})}),a.jsx(k,{variant:"subtle",rightSection:a.jsx(C,{}),className:r.more,children:"Читать"})]})]})})}));I.displayName="BlogPostCard";const H=v(()=>{const e=z(5,{name:"$pageSize",sid:"2aag3l"}),s=p(i.finished.success.map(({result:t})=>t.payload),[],{name:"$blogPosts",sid:"-vcd1gb"}),o=Q({name:"pageChanged",sid:"r1tfdz"}),n=p(o,1,{name:"$currentPage",sid:"-wvw5sq"}),l=B(()=>window.scrollTo(0,0),{name:"scrollToTopFx",sid:"muhy0j"});d({and:[{clock:o,target:l}],or:{sid:"-vcd65q"}}),d({and:[{clock:e,filter:i.$data.map(t=>{var c;return((c=t==null?void 0:t.payload)==null?void 0:c.length)<1}),fn:t=>({page:1,page_size:t}),target:i.refresh}],or:{sid:"-v9m76x"}}),d({and:[{clock:n,source:{page_size:e},fn:({page_size:t},c)=>({page:c,page_size:t}),target:i.refresh}],or:{sid:"-uurr66"}});const P=p(i.finished.success.map(t=>t.result.total_pages),1,{name:"$totalPages",sid:"1dwck0"}),f=B(async()=>{await $("/blog")},{name:"redirectToMainBlogPostPageFx",sid:"c6z4xt"});return d({and:[{clock:i.finished.failure,target:f}],or:{sid:"-txs3ki"}}),{$currentPage:n,$pageSize:e,pageChanged:o,$totalPages:P,redirectToMainBlogPostPageFx:f,$blogPosts:s}});export{H as B,I as a,Y as b,V as c,i as g};
