import{J as Nr,x as Er,y as Cr,z as Rr,j as A,B as Lt,K as rr,L as Ar,M as Or,N as zr,Q as nr,h as te,r as qr,E as _r,S as tt,l as yt,H as pr,f as Pe,T as rt,P as fr,U as Pr,V as Ir,W as Fr,X as Lr,m as Br}from"./chunk-fhOpLBbO.js";import{s as Dr}from"./chunk-C_kswpa0.js";import{G as ar,I as sr}from"./chunk-tbChFFKB.js";import{s as It}from"./chunk-89JKNHqV.js";import{s as Tr}from"./chunk-CX66qPcq.js";import{s as or}from"./chunk-CA7xGImb.js";import{L as vt}from"./chunk-BkEDIOZ3.js";import{s as Ft}from"./chunk-DZYA-Fcr.js";import"./chunk-Cf7H87g2.js";import{s as Ye}from"./chunk-DHLn9X-S.js";import{M as ir}from"./chunk-DtPeIFfk.js";import{s as mt}from"./chunk-BPNsQ1As.js";import{s as ht}from"./chunk-CG4tMHVA.js";var mr={root:"m_ddec01c0",icon:"m_dde7bd57",cite:"m_dde51a35"};const Vr={iconSize:48},Ur=Rr((v,{color:b,iconSize:u,radius:V})=>{const N=rr({color:b||v.primaryColor,theme:v,colorScheme:"dark"}),Q=rr({color:b||v.primaryColor,theme:v,colorScheme:"light"});return{root:{"--bq-bg-light":nr(Q.value,.07),"--bq-bg-dark":nr(N.value,.06),"--bq-bd":zr(b,v),"--bq-icon-size":Or(u),"--bq-radius":Ar(V)}}}),Bt=Nr((v,b)=>{const u=Er("Blockquote",Vr,v),{classNames:V,className:N,style:Q,styles:Ne,unstyled:Oe,vars:X,children:ue,icon:ke,iconSize:ae,cite:Z,...Ee}=u,ie=Cr({name:"Blockquote",classes:mr,props:u,className:N,style:Q,classNames:V,styles:Ne,unstyled:Oe,vars:X,varsResolver:Ur});return A.jsxs(Lt,{component:"blockquote",ref:b,...ie("root"),...Ee,children:[ke&&A.jsx("span",{...ie("icon"),children:ke}),ue,Z&&A.jsx("cite",{...ie("cite"),children:Z})]})});Bt.classes=mr;Bt.displayName="@mantine/core/Blockquote";const Wr=new Map([["bold",te.createElement(te.Fragment,null,te.createElement("path",{d:"M232.49,80.49l-128,128a12,12,0,0,1-17,0l-56-56a12,12,0,1,1,17-17L96,183,215.51,63.51a12,12,0,0,1,17,17Z"}))],["duotone",te.createElement(te.Fragment,null,te.createElement("path",{d:"M232,56V200a16,16,0,0,1-16,16H40a16,16,0,0,1-16-16V56A16,16,0,0,1,40,40H216A16,16,0,0,1,232,56Z",opacity:"0.2"}),te.createElement("path",{d:"M205.66,85.66l-96,96a8,8,0,0,1-11.32,0l-40-40a8,8,0,0,1,11.32-11.32L104,164.69l90.34-90.35a8,8,0,0,1,11.32,11.32Z"}))],["fill",te.createElement(te.Fragment,null,te.createElement("path",{d:"M216,40H40A16,16,0,0,0,24,56V200a16,16,0,0,0,16,16H216a16,16,0,0,0,16-16V56A16,16,0,0,0,216,40ZM205.66,85.66l-96,96a8,8,0,0,1-11.32,0l-40-40a8,8,0,0,1,11.32-11.32L104,164.69l90.34-90.35a8,8,0,0,1,11.32,11.32Z"}))],["light",te.createElement(te.Fragment,null,te.createElement("path",{d:"M228.24,76.24l-128,128a6,6,0,0,1-8.48,0l-56-56a6,6,0,0,1,8.48-8.48L96,191.51,219.76,67.76a6,6,0,0,1,8.48,8.48Z"}))],["regular",te.createElement(te.Fragment,null,te.createElement("path",{d:"M229.66,77.66l-128,128a8,8,0,0,1-11.32,0l-56-56a8,8,0,0,1,11.32-11.32L96,188.69,218.34,66.34a8,8,0,0,1,11.32,11.32Z"}))],["thin",te.createElement(te.Fragment,null,te.createElement("path",{d:"M226.83,74.83l-128,128a4,4,0,0,1-5.66,0l-56-56a4,4,0,0,1,5.66-5.66L96,194.34,221.17,69.17a4,4,0,1,1,5.66,5.66Z"}))]]);var Kr=Object.defineProperty,Zr=Object.defineProperties,Gr=Object.getOwnPropertyDescriptors,cr=Object.getOwnPropertySymbols,Hr=Object.prototype.hasOwnProperty,Jr=Object.prototype.propertyIsEnumerable,lr=(v,b,u)=>b in v?Kr(v,b,{enumerable:!0,configurable:!0,writable:!0,value:u}):v[b]=u,Qr=(v,b)=>{for(var u in b||(b={}))Hr.call(b,u)&&lr(v,u,b[u]);if(cr)for(var u of cr(b))Jr.call(b,u)&&lr(v,u,b[u]);return v},Xr=(v,b)=>Zr(v,Gr(b));const hr=qr.forwardRef((v,b)=>te.createElement(_r,Xr(Qr({ref:b},v),{weights:Wr})));hr.displayName="Check";const Yr=({points:v,color:b="violet",...u})=>!v||!v.length?null:A.jsx(tt,{className:yt(ht.stack,u.className),children:v.map((V,N)=>A.jsxs(pr,{className:ht.point,children:[A.jsx(hr,{className:ht.check,weight:"bold",color:`var(--mantine-color-${b}-9)`}),A.jsx(Pe,{className:ht.text,children:V})]},`${V}_${N}`))}),en=({text:v,c:b="violet.9",...u})=>A.jsx(rt,{className:Dr.title,order:5,c:b,...u,children:v}),gr=({text:v,className:b,...u})=>A.jsx(ir,{options:{overrides:{p:V=>A.jsx(Pe,{className:yt(mt.text,b),...u,children:V.children}),span:V=>A.jsx(Pe,{span:!0,className:yt(mt.text,b),...u,children:V.children}),pre:V=>A.jsx(Pe,{className:yt(mt.text,b),...u,children:V.children}),code:V=>A.jsx(ir,{className:mt.text,children:V.children})}},children:v}),tn=({items:v,color:b})=>A.jsx(ar,{grow:!0,children:v.map((u,V)=>A.jsx(ar.Col,{span:6,children:A.jsx(fr,{h:"100%",radius:30,px:"3xl",py:22,bg:`${b}.0`,children:A.jsxs(tt,{gap:"xs",children:[A.jsx(rt,{c:`${b}.9`,fz:24,order:4,children:u.title}),A.jsx(Pe,{fz:20,children:u.text})]})})},V))}),rn=({items:v,color:b})=>A.jsx(tt,{children:v.map(u=>A.jsx(fr,{className:It.paper,bg:b==="positive"?"green.0":"pink.0",children:A.jsx(tt,{className:It.stack,children:A.jsxs(rt,{className:It.title,c:b==="positive"?"green.9":"pink.9",order:5,children:[u.order,". ",u.title]})})},u.order))}),nn=({type:v,text:b})=>A.jsx(rt,{"data-type":v,className:Tr.subtitle,order:3,mb:"md",children:b});function gt(v){return Array.isArray(v)}const an=(v,b)=>{switch(v.type){case"header":return A.jsx(en,{...v});case"paragraph":return A.jsx(gr,{...v});case"cards":return gt(v.items)&&A.jsx(tn,{items:v.items,color:b});case"ordered_cards":return A.jsx(rn,{color:v.color,items:gt(v.items)?v.items:[]});case"subtitle":return A.jsx(nn,{...v});case"ordered_list":return A.jsx(sn,{color:b,"data-type":v.type,items:gt(v.items)?v.items:[]});case"blockquote_line":return A.jsx(on,{text:v.text,color:b});case"filled_bullet_list":return A.jsx(cn,{"data-color":b,items:gt(v.items)?v.items:[]});case"paywall":return A.jsx(fn,{...v})}},sn=({items:v,color:b})=>A.jsx(vt,{"data-type":"Ordered List",type:"ordered",className:or.list,"data-color":b,children:v==null?void 0:v.map((u,V)=>{var N;return A.jsxs(vt.Item,{children:[A.jsx(rt,{"data-color":b,mb:"md",className:or.title,children:u.title}),(N=u.content)==null?void 0:N.map((Q,Ne)=>A.jsx(tt,{children:an(Q,b??"violet")},Q.type+Ne))]},V)})}),on=({text:v,color:b})=>A.jsx(Bt,{mb:"md",py:"sm",px:"md",color:`${b}.9`,bg:"transparent",icon:null,children:A.jsx(gr,{text:v??""})}),cn=({items:v,...b})=>A.jsx(vt,{"data-type":"Filled Bullet List",classNames:Ft,...b,children:v==null?void 0:v.map(u=>{var V,N;return A.jsxs(vt.Item,{hidden:!u.text&&!u.title,mb:"md",children:[A.jsx(Pe,{lh:"21px",className:Ft.text,span:((V=u.text)==null?void 0:V.startsWith(" — "))||((N=u.title)==null?void 0:N.endsWith(": ")),children:u.title}),A.jsx(Pe,{className:Ft.text,span:!0,c:"dark.7",lh:"21px",children:u.text})]},`${u.type}_${u.title}`)})});var et={exports:{}},T={},ur;function ln(){if(ur)return T;ur=1;function v(e,t){for(const r in e)t(e[r],r)}function b(e,t){e.forEach(t)}function u(e,t,r){if(!e)throw Error(`${r?r+": ":""}${t}`)}function V(e,t){const r=H(e),a=r.meta||{};Y(e)||(a.isRegion=1),pe={id:r.id,parent:pe,value:e,template:a.template||Te(),sidRoot:a.sidRoot||pe&&pe.sidRoot,meta:a};try{return t()}finally{bt("region"),pe=f(pe)}}function N({node:e=[],from:t,source:r,parent:a=t||r,to:n,target:s,child:o=n||s,scope:i={},meta:d={},family:g={type:"regular"},regional:y}={}){const l=He(a),c=He(g.links),$=He(g.owners),p=[];b(e,M=>M&&D(p,M));const k={id:be(),seq:p,next:He(o),meta:d,scope:i,family:{triggers:l.length,type:g.type||"crosslink",links:c,owners:$}};return b(c,M=>D(Me(M),k)),b($,M=>D(ge(M),k)),b(l,M=>D(M.next,k)),y&&pe&&Ce(m(pe),[k]),k}function Q(e,t,r){let a,n=ve,s=null,o=G;if(e.target&&(t=e.params,r=e.defer,a=e.meta,n="page"in e?e.page:n,e.stack&&(s=e.stack),o=S(e)||o,e=e.target),o&&G&&o!==G&&(G=null),Array.isArray(e))for(let p=0;p<e.length;p++)_e("pure",n,H(e[p]),s,t[p],o,a);else _e("pure",n,H(e),s,t,o,a);if(r&&!ot)return;const i={isRoot:ot,currentPage:ve,scope:G,isWatch:it,isPure:ct};let d,g,y,l,c,$;ot=0;e:for(;l=br();){const{idx:p,stack:k,type:M}=l;y=k.node,ve=c=k.page,G=S(k),c?$=c.reg:G&&($=G.reg);const w=!!c,L=!!G,x={fail:0,scope:y.scope};d=g=0;for(let C=p;C<y.seq.length&&!d;C++){const E=y.seq[C];if(E.order){const{priority:q,barrierID:I}=E.order,ee=I?c?`${c.fullID}_${I}`:I:0;if(C!==p||M!==q){I?Nt.has(ee)||(Nt.add(ee),$t(C,k,q,I)):$t(C,k,q,0);continue e}I&&Nt.delete(ee)}switch(E.type){case"mov":{const I=E.data;let ee;switch(I.from){case"stack":ee=m(k);break;case"a":case"b":ee=k[I.from];break;case"value":ee=I.store;break;case"store":if($&&!$[I.store.id])if(w){const Ae=Zt(c,I.store.id);k.page=c=Ae,Ae?$=Ae.reg:L?(We(G,I.store,0,1,I.softRead),$=G.reg):$=void 0}else L&&We(G,I.store,0,1,I.softRead);ee=Qe($&&$[I.store.id]||I.store)}switch(I.to){case"stack":k.value=ee;break;case"a":case"b":k[I.to]=ee;break;case"store":Et(c,G,I.target,0).current=ee}break}case"compute":const q=E.data;if(q.fn){it=y.meta.op==="watch",ct=q.pure;const I=q.safe?(0,q.fn)(m(k),x.scope,k):kr(x,q.fn,k);q.filter?g=!I:k.value=I,it=i.isWatch,ct=i.isPure}}d=x.fail||g}if(Ct&&Ct(k,x),!d){const C=m(k),E=S(k);if(b(y.next,q=>{_e("child",c,q,k,C,E)}),E){y.meta.needFxCounter&&_e("child",c,E.fxCount,k,C,E),y.meta.storeChange&&_e("child",c,E.storeChange,k,C,E),y.meta.warnSerialize&&_e("child",c,E.warnSerializeNode,k,C,E);const q=E.additionalLinks[y.id];q&&b(q,I=>{_e("child",c,I,k,C,E)})}}}ot=i.isRoot,ve=i.currentPage,G=S(i)}function Ne(e,t="combine"){let r=t+"(",a="",n=0;return v(e,s=>{n<25&&(s!=null&&(r+=a,r+=j(s)?_(s).fullName:s.toString()),n+=1,a=", ")}),r+")"}function Oe(e,t){let r,a;const n=e;if(t){const s=_(t);e.length===0?(r=s.path,a=s.fullName):(r=s.path.concat([e]),a=s.fullName.length===0?e:s.fullName+"/"+e)}else r=e.length===0?[]:[e],a=e;return{shortName:n,fullName:a,path:r}}function X(e,t){if(!t||!t.name&&!t.named&&!t.loc)return e;let r=`[${e}]`;const a=t.named||t.name;a&&(r+=` unit '${a}'`);const n=t.loc;return!a&&n&&(r+=` (${n.file}:${n.line}:${n.column})`),r}function ue(e,t){const r=t?e:e[0];xt(r);let a=r.or;const n=r.and;if(n){const s=t?n:n[0];if(me(s)&&"and"in s){const o=ue(n,t);e=o[0],a={...a,...o[1]}}else e=n}return[e,a]}function ke(e){const t=()=>e();return t.unsubscribe=()=>e(),t}function ae(e,...t){const r=Te();if(r){const a=r.handlers[e];if(a)return a(r,...t)}}function Z(e,t){const r=Re({or:t,and:typeof e=="string"?{name:e}:e}),a=X("event",r),n=(i,...d)=>(u(!h(n,"derived"),"call of derived event is not supported, use createEvent instead",a),u(!ct,"unit call from pure function is not supported, use operators like sample instead",a),ve?((g,y,l,c)=>{const $=ve;let p=null;if(y)for(p=ve;p&&p.template!==y;)p=f(p);Kt(p);const k=g.create(l,c);return Kt($),k})(n,s,i,d):n.create(i,d)),s=Te(),o=Object.assign(n,{graphite:N({meta:Ot(r.actualOp||"event",n,r),regional:1}),create:i=>(Q({target:n,params:i,scope:G}),i),watch:i=>Jt(n,i),map:i=>zt(n,$e,i,[je()]),filter:i=>zt(n,"filter",i.fn?i:i.fn,[je(at,1)]),filterMap:i=>zt(n,"filterMap",i,[je(),oe(d=>!he(d),1)]),prepend(i){u(n.targetable,".prepend of derived event is not supported, call source event instead",a);const d=Z("* → "+n.shortName,{parent:f(n)});return ae("eventPrepend",H(d)),we(d,n,[je()],"prepend",i),At(n,d),d}});return r!=null&&r.domain&&r.domain.hooks.event(o),O(o,"id",o.graphite.id),bt(o.graphite),o}function Ee(e,t,r,a,n){return Ve(r,`${n} ${t}`,"first argument"),u(fe(a),"second argument should be a function",n),re(!h(e,"derived"),`${t} in derived store`,`${t} in store created via createStore`,n),b(Array.isArray(r)?r:[r],s=>{e.off(s),Qt(s,e,"on",yr,a)}),e}function ie(e,t){const r=Re(t),a=qe(e),n=X("store",r),s=Error();Error.captureStackTrace&&Error.captureStackTrace(s,ie);const o=s.stack,i=Z({named:"updates",derived:1});ae("storeBase",a);const d=a.id,g="skipVoid"in r,y=g&&!r.skipVoid;re(!(g&&r.skipVoid),"{skipVoid: true}","updateFilter",n);const l={updates:i,defaultState:e,stateRef:a,getState(){let x,C=a;if(ve){let E=ve;for(;E&&!E.reg[d];)E=f(E);E&&(x=E)}return!x&&G&&(We(G,a,1),x=G),x&&(C=x.reg[d]),Qe(C)},setState:x=>Q({target:l,params:x,defer:1,scope:G}),reset:(...x)=>(u(l.targetable,".reset of derived store is not supported",n),b(x,C=>Ee(l,".reset",C,()=>l.defaultState,n)),l),on:(x,C)=>(u(l.targetable,".on of derived store is not supported",n),Ee(l,".on",x,C,n)),off(x){const C=H(x).id,E=H(l).family.links.find(q=>q.meta.onTrigger===C);return E&&Xe(E),l},map(x,C){let E,q;me(x)&&(E=x,x=x.fn);const I=l.getState(),ee=he(I);Te()?q=null:(!ee||ee&&y)&&(q=x(I));const Ae=ie(q,{name:`${l.shortName} → *`,derived:1,...C,and:E}),Mr=Qt(l,Ae,$e,at,x);return st(se(Ae),{type:$e,fn:x,from:a}),se(Ae).noInit=1,ae("storeMap",a,Mr),Ae},watch(x,C){if(re(!C,"watch second argument","sample",n),!C||!j(x)){const E=Jt(l,x);return ae("storeWatch",a,x)||x(l.getState()),E}return u(fe(C),"second argument should be a function",n),x.watch(E=>C(l.getState(),E))}},c=Ot("store",l,r),$=l.defaultConfig.updateFilter;l.graphite=N({scope:{state:a,fn:$},node:[oe((x,C,E)=>(E.scope&&!E.scope.reg[a.id]&&(E.b=1),x)),xe(a),oe((x,C,{a:E,b:q})=>{const I=he(x);return I&&!g&&le(`${n}: ${pt}`,o),(I&&y||!I)&&(x!==E||q)},1),$&&je(Vt,1),ye({from:"stack",target:a})],child:i,meta:{...c,defaultState:e,storeTrace:o},regional:1}),O(l,"id",l.graphite.id),O(l,"rootStateRefId",d);const p=h(l,"serialize"),k=h(l,"derived"),M=p==="ignore",w=h(l,"sid");w&&(O(l,"storeChange",1),a.sid=w),w||M||k||O(l,"warnSerialize",1);const L=he(e);return u(k||!L||L&&y,pt,n),k&&L&&!g&&console.error(`${n}: ${pt}`),Ce(l,[i]),r!=null&&r.domain&&r.domain.hooks.store(l),k||(l.reinit=Z({named:"reinit"}),l.reset(l.reinit)),a.meta=l.graphite.meta,bt(l.graphite),l}function Ie(...e){let t,r,a;[e,a]=ue(e);const n=X("combine",a),s=e[e.length-1],o=e.length>1&&!R(s)&&me(s),i=o&&s,d=o?e[e.length-2]:s;let g,y,l;if(fe(d)?(r=e.slice(0,o?-2:-1),t=d):r=e,r.length===1){const c=r[0];R(c)||(g=c,y=1)}if(!y&&(g=r,t)){l=1;const c=t;t=$=>c(...$)}return u(me(g),`${n}: shape should be an object`),Sr(Array.isArray(g),!l,g,a,t,i)}function nt(){const e={};return e.req=new Promise((t,r)=>{e.rs=t,e.rj=r}),e.req.catch(()=>{}),e}function U(e,t={}){const r=Re(fe(e)?{handler:e}:e,t),a=X("effect",r),n=Z(fe(e)?{handler:e}:e,{...t,actualOp:"effect"}),s=H(n);O(s,"op",n.kind="effect"),n.use=p=>(u(fe(p),".use argument should be a function",a),l.scope.handler=p,n),n.use.getCurrent=()=>l.scope.handler;const o=n.finally=Z({named:"finally",derived:1}),i=n.done=o.filterMap({named:"done",fn({status:p,params:k,result:M}){if(p==="done")return{params:k,result:M}}}),d=n.fail=o.filterMap({named:"fail",fn({status:p,params:k,error:M}){if(p==="fail")return{params:k,error:M}}}),g=n.doneData=i.map({named:"doneData",fn:({result:p})=>p}),y=n.failData=d.map({named:"failData",fn:({error:p})=>p}),l=N({scope:{handler:n.defaultConfig.handler||(()=>u(0,`no handler used in ${n.compositeName.fullName}`))},node:[oe((p,k,M)=>{let w=k.handler;const L=S(M);if(L){const x=L.handlers.unitMap.get(n)||L.handlers.sidMap[n.sid];x&&(w=x)}return p.handler=w,p},0,1),oe((p,k,M)=>{if(k.runnerFn&&!k.runnerFn(p,null,M))return;const{params:w,req:L,handler:x,args:C=[w]}=p,E=ft(w,L,1,o,M),q=ft(w,L,0,o,M),[I,ee]=Xt(x,q,C);I&&(me(ee)&&fe(ee.then)?ee.then(E,q):E(ee))},0,1)],meta:{op:"fx",fx:"runner"},regional:1});s.scope.runner=l,D(s.seq,oe((p,{runner:k},M)=>{const w=f(M)?{params:p,req:{rs(L){},rj(L){}}}:p;return M.meta||(M.meta={fxID:De()}),Q({target:k,params:w,defer:1,scope:S(M),meta:M.meta}),w.params})),n.create=p=>{const k=nt(),M={params:p,req:k};if(G&&!it){const w=G;k.req.finally(()=>{lt(w)}).catch(()=>{})}return Q({target:n,params:M,scope:G}),k.req};const c=n.inFlight=ie(0,{serialize:"ignore",named:(h(n,"name")||n.graphite.id)+".inFlight"}).on(n,p=>p+1).on(o,p=>p-1).map({fn:p=>p,named:"inFlight"});O(o,"needFxCounter","dec"),O(n,"needFxCounter",1);const $=n.pending=c.map({fn:p=>p>0,named:"pending"});return Ce(n,[o,i,d,g,y,$,c]),r!=null&&r.domain&&r.domain.hooks.effect(n),n}function de(e,t){let r=0;return b(wr,a=>{a in e&&(u(e[a]!=null,Yt(t,a)),r=1)}),r}function Fe(e,t,r){const a=[];(function n(s){B(a,s)||(D(a,s),h(s,"op")==="store"&&(r||h(s,"sid"))&&t(s,h(s,"sid")),b(s.next,n),b(Me(s),n),b(ge(s),n))})(e)}function Le(e,t){const r=Array.isArray(e)?new Map(e):e,a=new Map;let n=0;if(r instanceof Map){const s={};return b(r,(o,i)=>{u(j(i),"Map key should be a unit"),t&&t(i,o),i.sid&&(i.sid in s&&(n=1),s[i.sid]=o),a.set(i,o)}),{sidMap:s,unitMap:a,hasSidDoubles:n}}return{sidMap:r,unitMap:a}}function Ke(e,t){return R(t)?[Je.mov({store:t.stateRef,to:"stack"}),...e]:e}Object.defineProperty(T,"__esModule",{value:1});const Be=typeof Symbol<"u"&&Symbol.observable||"@@observable",$e="map",H=e=>e.graphite||e,Me=e=>e.family.owners,ge=e=>e.family.links,se=e=>e.stateRef,m=e=>e.value,f=e=>e.parent,S=e=>e.scope,h=(e,t)=>H(e).meta[t],O=(e,t,r)=>H(e).meta[t]=r,_=e=>e.compositeName,j=e=>(fe(e)||me(e))&&"kind"in e,P=e=>t=>j(t)&&t.kind===e,R=P("store"),W=P("event"),F=P("effect"),J=e=>j(e)&&!!e.targetable,Y=P("domain"),K=P("scope");var z={__proto__:null,unit:j,store:R,event:W,effect:F,targetable:J,domain:Y,scope:K,attached:e=>F(e)&&h(e,"attached")==1};const B=(e,t)=>e.includes(t),ce=(e,t)=>{const r=e.indexOf(t);r!==-1&&e.splice(r,1)},D=(e,t)=>e.push(t),re=(e,t,r,a)=>!e&&console.error(`${a?a+": ":""}${t} is deprecated${r?`, use ${r} instead`:""}`),le=(e,t)=>{const r=Error(e);r.stack=t,console.error(r)},ne=()=>{let e=0;return()=>""+ ++e},Ze=ne(),Ge=ne(),be=ne(),De=ne();let Se,pe=null;const bt=e=>{Se&&Se(e,pe)},Te=()=>pe&&pe.template,Dt=e=>(e&&pe&&pe.sidRoot&&(e=`${pe.sidRoot}|${e}`),e),Ce=(e,t)=>{const r=H(e);b(t,a=>{const n=H(a);r.family.type!=="domain"&&(n.family.type="crosslink"),D(Me(n),r),D(ge(r),n)})},He=(e=[])=>(Array.isArray(e)?e:[e]).flat().map(H),me=e=>typeof e=="object"&&e!==null,fe=e=>typeof e=="function",he=e=>e===void 0,xt=e=>u(me(e)||fe(e),"expect first argument be an object"),Tt=(e,t,r,a)=>u(!(!me(e)&&!fe(e)||!("family"in e)&&!("graphite"in e)),`${t}: expect ${r} to be a unit (store, event or effect)${a}`),Ve=(e,t,r)=>{Array.isArray(e)?b(e,(a,n)=>Tt(a,t,`${n} item of ${r}`,"")):Tt(e,t,r," or array of units")},kt=(e,t,r="target")=>b(He(t),a=>u(!h(a,"derived"),`${e}: derived unit in "${r}" is not supported, use createStore/createEvent instead"`)),Vt=(e,{fn:t},{a:r})=>t(e,r),yr=(e,{fn:t},{a:r})=>t(r,e),at=(e,{fn:t})=>t(e),Ut=(e,t,r,a)=>{const n={id:Ge(),type:e,data:t};return r&&(n.order={priority:r},a&&(n.order.barrierID=++vr)),n};let vr=0;const ye=({from:e="store",store:t,target:r,to:a=r?"store":"stack",batch:n,priority:s})=>Ut("mov",{from:e,store:t,to:a,target:r},s,n),ze=({fn:e,batch:t,priority:r,safe:a=0,filter:n=0,pure:s=0})=>Ut("compute",{fn:e,safe:a,filter:n,pure:s},r,t),St=({fn:e})=>ze({fn:e,priority:"effect"}),oe=(e,t,r)=>ze({fn:e,safe:1,filter:t,priority:r&&"effect"}),xe=(e,t,r)=>ye({store:e,to:t?"stack":"a",priority:r&&"sampler",batch:1}),je=(e=at,t)=>ze({fn:e,pure:1,filter:t}),Je={mov:ye,compute:ze,filter:({fn:e,pure:t})=>ze({fn:e,filter:1,pure:t}),run:St},qe=e=>({id:Ge(),current:e,initial:e}),Qe=({current:e})=>e,st=(e,t)=>{e.before||(e.before=[]),D(e.before,t)};let Ue=null;const jt=(e,t)=>{if(!e)return t;if(!t)return e;let r;return(e.v.type===t.v.type&&e.v.id>t.v.id||Mt(e.v.type)>Mt(t.v.type))&&(r=e,e=t,t=r),r=jt(e.r,t),e.r=e.l,e.l=r,e},wt=[];let Wt=0;for(;Wt<6;)D(wt,{first:null,last:null,size:0}),Wt+=1;const br=()=>{for(let e=0;e<6;e++){const t=wt[e];if(t.size>0){if(e===3||e===4){t.size-=1;const a=Ue.v;return Ue=jt(Ue.l,Ue.r),a}t.size===1&&(t.last=null);const r=t.first;return t.first=r.r,t.size-=1,r.v}}},_e=(e,t,r,a,n,s,o)=>$t(0,{a:null,b:null,node:r,parent:a,value:n,page:t,scope:s,meta:o},e,0),$t=(e,t,r,a)=>{const n=Mt(r),s=wt[n],o={v:{idx:e,stack:t,type:r,id:a},l:null,r:null};n===3||n===4?Ue=jt(Ue,o):(s.size===0?s.first=o:s.last.r=o,s.last=o),s.size+=1},Mt=e=>{switch(e){case"child":return 0;case"pure":return 1;case"read":return 2;case"barrier":return 3;case"sampler":return 4;case"effect":return 5;default:return-1}},Nt=new Set;let G,ot=1,it=0,ct=0,ve=null;const lt=e=>{G=e},Kt=e=>{ve=e},Zt=(e,t)=>{if(e){for(;e&&!e.reg[t];)e=e.parent;if(e)return e}return null},Et=(e,t,r,a)=>{const n=Zt(e,r.id);return n?n.reg[r.id]:t?(We(t,r,a),t.reg[r.id]):r};let Ct;const xr=e=>e,We=(e,t,r,a,n)=>{const s=e.reg;if(s[t.id])return;const o=t.sid,i={id:t.id,current:t.initial,meta:t.meta};if(i.id in e.values.idMap)i.current=e.values.idMap[i.id];else if(o&&o in e.values.sidMap&&!(o in e.sidIdMap)){var d;const g=t==null||(d=t.meta)===null||d===void 0?void 0:d.serialize;i.current=(e.fromSerialize&&g!=="ignore"&&(g==null?void 0:g.read)||xr)(e.values.sidMap[o])}else if(t.before&&!n){let g=0;const y=r||!t.noInit||a;b(t.before,l=>{switch(l.type){case"map":{const c=l.from;if((c||l.fn)&&(c&&We(e,c,r,a),y)){const $=c&&s[c.id].current;i.current=l.fn?l.fn($):$}break}case"field":We(e,l.from,r,a),g||(g=1,i.current=Array.isArray(i.current)?[...i.current]:{...i.current}),y&&(i.current[l.field]=s[s[l.from.id].id].current)}})}o&&(e.sidIdMap[o]=t.id),s[t.id]=i},kr=(e,t,r)=>{try{return t(m(r),e.scope,r)}catch(a){console.error(a),e.fail=1,e.failReason=a}},Re=(e,t={})=>(me(e)&&(Re(e.or,t),v(e,(r,a)=>{he(r)||a==="or"||a==="and"||(t[a]=r)}),Re(e.and,t)),t),Gt=(e,t)=>{ce(e.next,t),ce(Me(e),t),ce(ge(e),t)},Ht=["on","reset","sample","split","merge","guard","forward"],ut=(e,t,r,a,n)=>{let s;e.next.length=0,e.seq.length=0,e.scope=null;let o=ge(e);const i=e.meta.isRegion,d=i?e:a;if(o.length>0){const g=B(Ht,e.meta.op),y=!i&&!n,l=y&&r&&!g;for(;s=o.pop();){const c=B(s.next,e);Gt(s,e),i&&ut(s,0,0,e,1),c||(s.family.triggers-=1),(t||l||y&&s.family.type==="crosslink"&&!g||n&&B(Ht,s.meta.op)&&(c&&s.next.length===0||!c&&s.family.triggers<=0))&&ut(s,t,r&&s.meta.op!=="on",d,n)}}for(o=Me(e);s=o.pop();)Gt(s,e),r&&s.family.type==="crosslink"&&ut(s,t,s.meta.op!=="on",d,n)},dt=e=>e.clear(),Xe=(e,{deep:t}={})=>{let r=0;if(e.ownerSet&&e.ownerSet.delete(e),Y(e)){r=1;const a=e.history;dt(a.events),dt(a.effects),dt(a.stores),dt(a.domains)}ut(H(e),!!t,r,null,0)},Rt=e=>ke(()=>Xe(e)),we=(e,t,r,a,n)=>N({node:r,parent:e,child:t,scope:{fn:n},meta:{op:a},family:{owners:[e,t],links:t},regional:1}),Jt=(e,t)=>(u(fe(t),".watch argument should be a function"),Rt(N({scope:{fn:t},node:[St({fn:at})],parent:e,meta:{op:"watch"},family:{owners:e},regional:1}))),At=(e,t,r="event")=>{f(e)&&f(e).hooks[r](t)},Ot=(e,t,r)=>{const a=Re(r),n=e==="domain",s=Ze(),{sid:o=null,named:i=null,domain:d=null,parent:g=d}=a,y=i||a.name||(n?"":s),l=Oe(y,g),c={op:t.kind=e,name:t.shortName=y,sid:t.sid=Dt(o),named:i,unitId:t.id=s,serialize:a.serialize,derived:a.derived,config:a};if(t.targetable=!a.derived,t.parent=g,t.compositeName=l,t.defaultConfig=a,t.getType=()=>(re(0,"getType","compositeName.fullName"),l.fullName),!n){t.subscribe=p=>(xt(p),t.watch(fe(p)?p:k=>p.next&&p.next(k))),t[Be]=()=>t;const $=Te();$&&(c.nativeTemplate=$)}return c},zt=(e,t,r,a)=>{let n;me(r)&&(n=r,r=r.fn);const s=Z({name:`${e.shortName} → *`,derived:1,and:n});return we(e,s,a,t,r),s},pt="undefined is used to skip updates. To allow undefined as a value provide explicit { skipVoid: false } option",Qt=(e,t,r,a,n)=>{const s=se(t),o=ye({store:s,to:"a",priority:"read"});r===$e&&(o.data.softRead=1);const i=[o,je(a)];ae("storeOnMap",s,i,R(e)&&se(e));const d=we(e,t,i,r,n);return r!==$e&&O(d,"onTrigger",H(e).id),d},Sr=(e,t,r,a,n,s)=>{const o=X("combine",a),i=e?w=>[...w]:w=>({...w}),d=e?[]:{},g=i(d),y=qe(g),l=qe(1);y.type=e?"list":"shape",y.noInit=1,ae("combineBase",y,l);const c=ie(g,{name:Ne(r),derived:1,...s,and:a}),$=se(c);$.noInit=1,O(c,"isCombine",1);const p=xe(y);p.order={priority:"barrier"};const k=ye({store:$,to:"b",priority:"read"});k.data.softRead=1;const M=[oe((w,L,x)=>(x.scope&&!x.scope.reg[y.id]&&(x.c=1),w)),p,ye({store:l,to:"b"}),oe((w,{key:L},x)=>{if(x.c||w!==x.a[L])return t&&x.b&&(x.a=i(x.a)),x.a[L]=w,1},1),ye({from:"a",target:y}),ye({from:"value",store:0,target:l}),ye({from:"value",store:1,target:l,priority:"barrier",batch:1}),xe(y,1,1),n&&je(),k];if(v(r,(w,L)=>{if(!R(w))return u(!j(w)&&!he(w),`combine expects a store in a field ${L}`,o),void(g[L]=d[L]=w);d[L]=w.defaultState,g[L]=w.getState();const x=we(w,c,M,"combine",n);x.scope.key=L;const C=se(w);st(y,{type:"field",field:L,from:C}),ae("combineField",C,x)}),c.defaultShape=r,st($,{type:$e,from:y,fn:n}),!Te())if(n){const w=n(g);!he(w)||s&&"skipVoid"in s||console.error(`${o}: ${pt}`),$.current=w,$.initial=w,c.defaultState=w}else c.defaultState=d;return c},Xt=(e,t,r)=>{try{return[1,e(...r)]}catch(a){return t(a),[0,null]}},ft=(e,t,r,a,n)=>s=>{Q({target:[a,jr],params:[r?{status:"done",params:e,result:s}:{status:"fail",params:e,error:s},{value:s,fn:r?t.rs:t.rj}],defer:1,page:n.page,scope:n.scope,meta:n.meta})},jr=N({node:[St({fn:({fn:e,value:t})=>e(t)})],meta:{op:"fx",fx:"sidechain"}}),wr=["source","clock","target"],Yt=(e,t)=>e+`: ${t} should be defined`,qt=(e,t,r,a,n,s,o,i,d,g,y,l)=>{const c=X(e,i),$=!!n;u(!he(r)||!he(t),Yt(c,"either source or clock"));let p=0;he(r)?p=1:j(r)||(r=Ie(r)),he(t)?t=r:(Ve(t,c,"clock"),Array.isArray(t)&&(t=we(t,[],[],e))),p&&(r=t),i||o||(o=r.shortName);let k="none";(y||a)&&(j(a)?k="unit":(u(fe(a),"`filter` should be function or unit"),k="fn")),n?(Ve(n,c,"target"),kt(c,n)):k==="none"&&g&&R(r)&&R(t)?n=ie(s?s(Qe(se(r)),Qe(se(t))):Qe(se(r)),{name:o,sid:l,or:i}):(n=Z({name:o,derived:1,or:i}),ae("sampleTarget",H(n)));const M=qe();let w=[];if(k==="unit"){const[C,E,q]=er(a,n,t,M,e);q||w.push(..._t(E)),w.push(..._t(C))}const L=[];if(p)d&&L.push(xe(M,1,1));else{const[C,E,q]=er(r,n,t,M,e);q||L.push(..._t(E)),L.push(xe(C,1,d))}const x=we(t,n,[ae("sampleSourceLoader"),ye({from:"stack",target:M}),...L,...w,xe(M),k==="fn"&&je((C,E,{a:q})=>a(C,q),1),s&&je(Vt),ae("sampleSourceUpward",$)],e,s);return Ce(r,[x]),Object.assign(x.meta,i,{joint:1}),n},_t=e=>[xe(e),oe((t,r,{a})=>a,1)],er=(e,t,r,a,n)=>{const s=R(e),o=s?se(e):qe(),i=qe(s);return s||N({parent:e,node:[ye({from:"stack",target:o}),ye({from:"value",store:1,target:i})],family:{owners:[...new Set([e,t,r].flat())],links:t},meta:{op:n},regional:1}),ae("sampleSource",i,o,a),[o,i,s]},Pt=(e,t,r,a)=>{const n=e[t];n&&Q({target:n,params:Array.isArray(n)?n.map(()=>r):r,defer:1,stack:a})},tr=e=>!e.node.meta.isCombine||e.parent&&e.parent.node.meta.op!=="combine",$r=e=>e;return T.allSettled=(e,{scope:t,params:r}={})=>{if(!j(e))return Promise.reject(new Error("first argument should be unit"));if(!(F(e)||W(e)||R(e)||K(e)))return Promise.reject(new Error("first argument accepts only effects, events, stores or scopes"));if(K(e))t=e;else if(!J(e)){const i=X("allSettled",H(e).meta);return Promise.reject(Error(`${i}: unit should be targetable`))}const a=nt();a.parentFork=G;const{fxCount:n}=t;D(n.scope.defers,a);const s=[],o=[];return K(e)||(D(s,e),D(o,F(e)?{params:r,req:{rs(i){a.value={status:"done",value:i}},rj(i){a.value={status:"fail",value:i}}}}:r)),D(s,n),D(o,null),Q({target:s,params:o,scope:t}),a.req},T.attach=e=>{let t;[e,t]=ue(e,1);const r=X("attach",t);let{source:a,effect:n,mapParams:s,domain:o}=e;F(n)&&u(he(o),"`domain` can only be used with a plain function",r);const i=U(e,t);O(i,"attached",1);const{runner:d}=H(i).scope;let g;const y=(c,$,p)=>{const{params:k,req:M,handler:w}=c,L=i.finally,x=ft(k,M,0,L,p),C=p.a,E=F(w);let q,I=1;if(s?[I,q]=Xt(s,x,[k,C]):q=a&&E?C:k,I){if(!E)return c.args=[C,q],1;Q({target:w,params:{params:q,req:{rs:ft(k,M,1,L,p),rj:x}},page:p.page,defer:1,meta:p.meta})}};if(a){let c;d.scope.runnerFn=y,R(a)?(c=a,Ce(c,[i])):(c=Ie(a),Ce(i,[c])),g=[oe($=>$,0,1),xe(se(c))],delete d.seq[1].order}else g=[oe(y,1,1)];d.seq.splice(1,0,...g),i.use(n);const l=f(n);return l&&(Object.assign(_(i),Oe(i.shortName,l)),i.defaultConfig.parent=l),At(n,i,"effect"),i},T.clearNode=Xe,T.combine=Ie,T.createApi=(...e)=>{let[[t,r],a]=ue(e);const n={};return v(r,(s,o)=>{const i=n[o]=Z(o,{parent:f(t),config:a});t.on(i,s),At(t,i)}),n},T.createDomain=function e(t,r){const a=Re({or:r,and:typeof t=="string"?{name:t}:t}),n=N({family:{type:"domain"},regional:1,parent:(a==null?void 0:a.domain)||(a==null?void 0:a.parent)}),s={history:{},graphite:n,hooks:{}};n.meta=Ot("domain",s,{parent:(a==null?void 0:a.domain)||(a==null?void 0:a.parent),or:{...a,derived:1}}),v({Event:Z,Effect:U,Store:ie,Domain:e},(i,d)=>{const g=d.toLowerCase(),y=Z({named:`on${d}`});s.hooks[g]=y;const l=new Set;s.history[`${g}s`]=l,y.create=c=>(Q(y,c),c),D(H(y).seq,oe((c,$,p)=>(p.scope=null,c))),y.watch(c=>{Ce(s,[c]),l.add(c),c.ownerSet||(c.ownerSet=l),f(c)||(c.parent=s)}),Ce(s,[y]),s[`onCreate${d}`]=c=>(b(l,c),y.watch(c)),s[`create${d}`]=s[g]=(c,$)=>{const p=Re({and:$,or:c});return p!=null&&p.domain?i(c,$):y(i(c,{parent:s,or:p}))}});const o=f(s);return o&&v(s.hooks,(i,d)=>we(i,o.hooks[d])),a!=null&&a.domain&&a.domain.hooks.domain(s),s},T.createEffect=U,T.createEvent=Z,T.createNode=N,T.createStore=ie,T.createWatch=({unit:e,fn:t,scope:r,batch:a})=>{const n=[Je.run({fn:o=>t(o)})];a&&n.unshift(Je.compute({priority:"sampler",batch:1})),R(e)&&n.unshift(Je.mov({store:e.stateRef,to:"stack"}));const s=Array.isArray(e)?e:[e];if(r){const o=[],i=r.additionalLinks;return s.forEach(d=>{const g=i[d.graphite.id]||[];i[d.graphite.id]=g;const y=N({node:Ke(n,d),meta:{watchOp:d.kind}});g.push(y),o.push(()=>{const l=g.indexOf(y);l!==-1&&g.splice(l,1),Xe(y)})}),ke(()=>{o.forEach(d=>d())})}{const o=N({node:n,parent:s,family:{owners:s}});return ke(()=>{Xe(o)})}},T.fork=(e,t)=>{let r,a=e;Y(e)&&(re(0,"fork(domain)","fork()"),r=e,a=t);const n=(s=>{const o=N({scope:{defers:[],inFlight:0,fxID:0},node:[oe((y,l,c)=>{c.parent?c.parent.node.meta.needFxCounter==="dec"?l.inFlight-=1:(l.inFlight+=1,l.fxID+=1):l.fxID+=1}),ze({priority:"sampler",batch:1}),oe((y,l)=>{const{defers:c,fxID:$}=l;l.inFlight>0||c.length===0||Promise.resolve().then(()=>{l.fxID===$&&b(c.splice(0,c.length),p=>{lt(p.parentFork),p.rs(p.value)})})},0,1)]}),i=N({node:[oe((y,l,c)=>{const $=c.parent;if($){const p=$.node;if(tr($)){const k=S(c),M=p.meta.sid;k.sidIdMap[M]=p.scope.state.id,k.values.sidMap[M]=y;const w=p.meta.serialize;w&&k.sidSerializeSettings.set(M,w==="ignore"?{ignore:1}:{ignore:0,write:w.write})}}})]}),d=N({node:[oe((y,l,c)=>{const $=S(c),p=c.parent;$&&p&&tr(p)&&$.warnSerializeTraces.add(h(p.node,"storeTrace"))})]}),g={cloneOf:s,reg:{},values:{sidMap:{},idMap:{}},sidIdMap:{},sidSerializeSettings:new Map,getState(y){if("current"in y)return Et(ve,g,y,0).current;const l=H(y);return Et(ve,g,l.scope.state,1).current},kind:"scope",graphite:N({family:{type:"domain",links:[o,i,d]},meta:{unit:"fork"},scope:{forkInFlightCounter:o}}),additionalLinks:{},handlers:{sidMap:{},unitMap:new Map},fxCount:o,storeChange:i,warnSerializeTraces:new Set,warnSerializeNode:d};return g})(r);if(a){if(a.values){const{sidMap:s,unitMap:o,hasSidDoubles:i}=Le(a.values,d=>u(R(d)&&J(d),"Values map can contain only writable stores as keys"));Object.assign(n.values.sidMap,s),b(o,(d,g)=>{if(n.values.idMap[g.stateRef.id]=d,n.sidIdMap[h(g,"sid")]=g.stateRef.id,h(g,"serialize")==="ignore"){const y=h(g,"sid");n.sidSerializeSettings.set(y,{ignore:1})}}),n.fromSerialize=!(Array.isArray(a.values)||a.values instanceof Map),n.hasSidDoubles=i}a.handlers&&(re(a.handlers instanceof Map||Array.isArray(a.handlers),"object with handlers","array"),n.handlers=Le(a.handlers,s=>u(F(s),"Handlers map can contain only effects as keys")))}return n},T.forward=e=>{const t="forward",[{from:r,to:a},n]=ue(e,1),s=X(t,n);return re(0,t,"sample",s),Ve(r,s,'"from"'),Ve(a,s,'"to"'),kt(s,a,"to"),Rt(N({parent:r,child:a,meta:{op:t,config:n},family:{},regional:1}))},T.fromObservable=e=>{xt(e);const t=Be in e?e[Be]():e;u(t.subscribe,"expect observable to have .subscribe");const r=Z(),a=Rt(r);return t.subscribe({next:r,error:a,complete:a}),r},T.guard=(...e)=>{let[[t,r],a]=ue(e);const n=X("guard",a);return re(0,"guard","sample",n),r||(r=t,t=r.source),de(r,n),qt("guard",r.clock,t,r.filter,r.target,null,r.name,a,!r.greedy,0,1)},T.hydrate=(e,{values:t})=>{u(me(t),"values property should be an object");const{sidMap:r,unitMap:a}=Le(t),n=Object.getOwnPropertyNames(r),s={};b(a,(l,c)=>{s[c.stateRef.id]=c});const o=[],i=[];let d,g,y;K(e)?(d=e,y=1,u(d.cloneOf,"scope should be created from domain"),re(0,"hydrate(fork(domain), { values })","fork({ values })"),g=H(d.cloneOf)):Y(e)?(re(0,"hydrate(domain, { values })","fork({ values })"),g=H(e)):u(0,"first argument of hydrate should be domain or scope"),Fe(g,(l,c)=>{if(c&&B(n,c)){D(o,l);const $=h(l,"serialize");$&&$!=="ignore"&&(r[c]=$.read(r[c])),D(i,r[c])}else l.scope.state.id in s&&(D(o,l),D(i,a.get(s[l.scope.state.id])))},1),Q({target:o,params:i,scope:d}),y&&Object.assign(d.values.sidMap,r)},T.is=z,T.launch=Q,T.merge=(e,t)=>{const r=X("merge",t);Ve(e,r,"first argument");const a=Z({name:Ne(e,"merge"),derived:1,and:t});return we(e,a,[],"merge"),a},T.restore=(e,t,r)=>{const a=X("restore",r);if(u(!R(e),"restore($store) is not supported",a),W(e)||F(e)){const s=f(e),o=ie(t,{parent:s,name:e.shortName,and:r});return we(F(e)?e.doneData:e,o),s&&s.hooks.store(o),o}const n=Array.isArray(e)?[]:{};return v(e,(s,o)=>n[o]=R(s)?s:ie(s,{name:o})),n},T.sample=(...e)=>{let t,r,a,n,[[s,o,i],d]=ue(e),g=1;const y=X("sample",d);return he(o)&&me(s)&&de(s,y)&&(o=s.clock,i=s.fn,"batch"in s?g=s.batch:(re(!("greedy"in s),"greedy in sample","batch",y),g=!s.greedy),n=s.filter,t=s.target,r=s.name,a=s.sid,s=s.source),qt("sample",o,s,n,t,i,r,d,g,1,0,a)},T.scopeBind=(e,{scope:t,safe:r}={})=>{u(t||G||r,"scopeBind: scope not found");const a=t||G;return(...n)=>{function s(){lt(d)}let o,i=0;const d=G;lt(a);try{o=e(...n)}catch(g){o=g,i=1}if(s(),i)throw o;return o instanceof Promise&&o.then(s,s),o}},T.serialize=(e,t={})=>{e.warnSerializeTraces.size&&(console.error("serialize: One or more stores dont have sids, their values are omitted"),b(e.warnSerializeTraces,n=>{le("store should have sid or `serialize: ignore`",n)})),u(!e.hasSidDoubles,"duplicate sid found in this scope");const r=t.ignore?t.ignore.map(({sid:n})=>n):[],a={};return v(e.values.sidMap,(n,s)=>{var o;if(B(r,s))return;const i=e.sidIdMap[s],d=(o=e.sidSerializeSettings.get(s))!==null&&o!==void 0?o:{ignore:0,write:$r};d.ignore||(a[s]=(0,d.write)(i&&i in e.reg?e.reg[i].current:n))}),"onlyChanges"in t&&(re(0,"onlyChanges"),t.onlyChanges||(u(e.cloneOf,"scope should be created from domain"),Fe(H(e.cloneOf),(n,s)=>{s in a||B(r,s)||h(n,"isCombine")||h(n,"serialize")==="ignore"||(a[s]=e.getState(n))}))),a},T.setGraphInspector=e=>{Se=e},T.setInspector=e=>{Ct=e},T.setStoreName=(e,t)=>{e.shortName=t,Object.assign(_(e),Oe(t,f(e)))},T.split=(...e)=>{const t="split";let r,a,[[n,s],o]=ue(e);const i=X(t,o),d=!s;d&&(r=n.cases,s=n.match,a=n.clock,n=n.source);const g=R(s),y=!j(s)&&fe(s),l=!g&&!y&&me(s);u(j(n),"source must be a unit",i),r||(r={}),d?v(r,(M,w)=>kt(i,M,`cases.${w}`)):(u(l,"match should be an object",i),v(s,(M,w)=>r[w]=Z({derived:1,named:`cases.${w}`,and:o})),r.__=Z({derived:1,named:"cases.__",and:o}));const c=new Set([].concat(n,a||[],Object.values(r))),$=Object.keys(g||y?r:s);let p;if(g||y)g&&c.add(s),p=[g&&xe(se(s),0,1),ze({safe:g,filter:1,pure:!g,fn(M,w,L){const x=String(g?L.a:s(M));Pt(w,B($,x)?x:"__",M,L)}})];else if(l){const M=qe({});M.type="shape";const w=[];let L;v(s,(x,C)=>{if(j(x)){L=1,D(w,C),c.add(x);const E=we(x,[],[xe(M),oe((q,I,{a:ee})=>ee[C]=q)]);if(R(x)){M.current[C]=x.getState();const q=se(x);st(M,{from:q,field:C,type:"field"}),ae("splitMatchStore",q,E)}}}),L&&ae("splitBase",M),p=[L&&xe(M,0,1),je((x,C,E)=>{for(let q=0;q<$.length;q++){const I=$[q];if(B(w,I)?E.a[I]:s[I](x))return void Pt(C,I,x,E)}Pt(C,"__",x,E)},1)]}else u(0,"expect match to be unit, function or object");const k=N({meta:{op:t},parent:a?[]:n,scope:r,node:p,family:{owners:Array.from(c)},regional:1});if(a&&qt(t,a,n,null,k,null,t,o,0,0,0),!d)return r},T.step=Je,T.version="23.3.0",T.withFactory=({sid:e,name:t,loc:r,method:a,fn:n})=>V(N({meta:{sidRoot:Dt(e),sid:e,name:t,loc:r,method:a,type:"factory"},regional:1}),n),T.withRegion=V,T}var un=et.exports,dr;function dn(){return dr||(dr=1,function(v,b){((u,V)=>{V(b,Pr(),ln(),Ir(),Fr())})(un,(u,V,N,Q,Ne)=>{function Oe(m){return m&&typeof m=="object"&&"default"in m?m:{default:m}}function X(m,f){return f.displayName=m,f}function ue(m,f){const S=N.is.unit(m);let h={};S?h={unit:m}:"@@unitShape"in m?typeof m["@@unitShape"]=="function"?h=m["@@unitShape"]():de("expect @@unitShape to be a function"):h=m;const O=Array.isArray(h),_=U.default.useRef({stale:1,justSubscribed:0,scope:f}),[j,P,R,W,F]=U.default.useMemo(()=>{_.current.stale=1;const z=Array.isArray(h)?[]:{},B=[],ce=[],D=[],re=[];for(const le in h){if(!{}.hasOwnProperty.call(h,le))continue;const ne=h[le];N.is.unit(ne)||de(`expect useUnit ${S?"argument":`value in key "${le}"`} to be a unit`),N.is.event(ne)||N.is.effect(ne)?(z[le]=f?N.scopeBind(ne,{scope:f}):ne,D.push(le),re.push(ne)):(z[le]=null,B.push(le),ce.push(ne))}return[z,B,ce,D,re]},[_,f,...Object.keys(h),...Object.values(h)]),J=U.default.useRef({value:j,storeKeys:P,eventKeys:W,eventValues:F}),Y=U.default.useCallback(z=>{const B=_.current;return B.justSubscribed=1,N.createWatch({unit:R,fn:()=>{B.stale||(B.stale=1,z())},scope:f,batch:1})},[R,f,J,_]),K=U.default.useCallback(()=>{const z=J.current,B=_.current;let ce,D=0;const re=z.value,le=z.storeKeys,ne=z.eventKeys,Ze=z.eventValues,Ge=f!==B.scope;if(B.stale||B.justSubscribed||Ge){D=!B.justSubscribed||Ge,ce=O?[...j]:{...j},le.length===P.length&&ne.length===W.length||(D=1);for(let be=0;be<P.length;be++){const De=Ke(R[be],f),Se=P[be];D||(D=le.includes(Se)?re[Se]!==De:1),ce[Se]=De}for(let be=0;be<W.length;be++){const De=F[be],Se=W[be];D||(D=ne.includes(Se)?Ze[ne.indexOf(Se)]!==De:1)}}return D&&(z.value=ce),z.storeKeys=P,z.eventKeys=W,z.eventValues=F,B.stale=0,B.justSubscribed=!D,B.scope=f,S?z.value.unit:z.value},[Y,R,F,f,J,_]);return Q.useSyncExternalStore(Y,K,K)}function ke([m,f],S){let h,O,_,j,P=Be;f?(h=f,_=m,j=[]):{fn:h,store:_,keys:j,defaultValue:O,updateFilter:P=Be}=m,N.is.store(_)||de("useStoreMap expects a store"),Array.isArray(j)||de("useStoreMap expects an array as keys"),typeof h!="function"&&de("useStoreMap expects a function");const R=U.default.useCallback(K=>N.createWatch({unit:_,fn:K,scope:S}),[_,S]),W=U.default.useCallback(()=>Ke(_,S),[_,S]),F=U.default.useRef(),J=U.default.useRef(),Y=U.default.useRef(j);return Ne.useSyncExternalStoreWithSelector(R,W,W,K=>{if(F.current!==K||!((z,B)=>{if(!z||!B||z.length!==B.length)return 0;let ce=1;for(let D=0;D<z.length;D++)if(z[D]!==B[D]){ce=0;break}return ce})(Y.current,j)){let z=h(K,j);z===void 0&&O!==void 0&&(z=O),F.current=K,Y.current=j,z!==void 0&&(J.current=z)}return J.current},(K,z)=>!P(z,K))}function ae(m,f={},S){const{open:h,close:O,set:_}=ue({open:m.open,close:m.close,set:m.set},S),j=U.default.useMemo(()=>({open:h,close:O,set:_}),[m,h]),P=U.default.useRef({value:null,count:0});Fe(()=>(j.open(P.current.value),()=>j.close(P.current.value)),[j]),((R,W)=>{if(R===W)return 1;if(typeof R=="object"&&R!==null&&typeof W=="object"&&W!==null){const F=Object.keys(R),J=Object.keys(W);if(F.length!==J.length)return 0;for(let Y=0;Y<F.length;Y++){const K=F[Y];if(R[K]!==W[K])return 0}return 1}return 0})(P.current.value,f)||(P.current.value=f,P.current.count+=1),Fe(()=>{j.set(P.current.value)},[P.current.count])}function Z(m){const f=U.default.useContext($e);return m&&!f&&de("No scope found, consider adding <Provider> to app root"),f}function Ee(m,f){return((S,h)=>{Le(1,"useStore","useUnit"),N.is.store(S)||de("expect useStore argument to be a store");const O=U.default.useCallback(j=>N.createWatch({unit:S,fn:j,scope:h}),[S,h]),_=U.default.useCallback(()=>Ke(S,h),[S,h]);return Q.useSyncExternalStore(O,_,_)})(m,Z(f==null?void 0:f.forceScope))}function ie(m,f){function S(P){const R=U.default.useRef(P),W=Ee(h);Fe(()=>(_({props:R.current,state:h.getState()}),()=>{j({props:R.current,state:h.getState()})}),[]);const F=f(P,W);return R.current=P,F}let h;Me("createComponent","@effector/reflect"),N.is.store(m)?h=m:typeof m=="object"&&m!==null?h=N.combine(m):de("shape should be a store or object with stores");let O="Unknown";h&&h.shortName&&(O=h.shortName);const _=N.createEvent(),j=N.createEvent();return S.mounted=_,S.unmounted=j,X(`${O}.View`,S)}function Ie(m,f){const S=f?m:m[0];(_=>{(j=>{if(!j)throw Error("expect first argument be an object")})(ge(_)||(j=>typeof j=="function")(_))})(S);let h=S.or;const O=S.and;if(O){const _=O[0];if(ge(_)&&"and"in _){const j=Ie(O,f);m=j[0],h={...h,...j[1]}}else m=O}return[m,h]}function nt(m,f){const S=f&&(F=>ge(F)&&(F.and||F.or))(f[0])?f:[{and:f}],[[h,O],_]=Ie(S);let j,P={},R={},W=_;return typeof h=="string"?(R={name:h},(F=>ge(F)&&"sid"in F)(O)||(P=O||{})):(F=>ge(F)&&("domain"in F||"defaultState"in F||"name"in F))(h)&&(R=h,P=h.defaultState||{},j=h.domain),{hook:m,domain:j,defaultState:P,mainConfig:R,maybeConfig:W}}var U=Oe(V);const de=m=>{throw Error(m)},Fe=typeof window<"u"?U.default.useLayoutEffect:U.default.useEffect,Le=(m,f,S)=>{V.useEffect(()=>{console.error(`${f} is deprecated${`, prefer ${S} instead`}`)},[m,f,S])},Ke=(m,f)=>f?f.getState(m):m.getState(),Be=(m,f)=>m!==f,$e=U.default.createContext(null),{Provider:H}=$e,Me=(m,f)=>{console.error(`${m} is deprecated${f?`, use ${f} instead`:""}`)},ge=m=>typeof m=="object"&&m!==null,se=(m,f={})=>(ge(m)&&(se(m.or,f),((S,h)=>{for(const O in S)h(S[O],O)})(m,(S,h)=>{(O=>O===void 0)(S)||h==="or"||h==="and"||(f[h]=S)}),se(m.and,f)),f);u.Provider=H,u.connect=m=>(Me("connect","useUnit"),f=>{let S=m;return typeof m!="function"&&(S=f,f=m),X(`Connect(${S.displayName||S.name||"Unknown"})`,h=>U.default.createElement(S,{...h,...Ee(f)}))}),u.createComponent=ie,u.createGate=(...m)=>(({domain:f,defaultState:S,hook:h,mainConfig:O,maybeConfig:_})=>{function j(z){return h(j,z,Z()),null}const P=se({or:_,and:O}),R=`${f?`${f.compositeName.fullName}/`:""}${P.name||"gate"}`,W=N.createEvent({name:`${R}.set`,sid:P.sid?`${P.sid}|set`:void 0}),F=N.createEvent({name:`${R}.open`,sid:P.sid?`${P.sid}|open`:void 0}),J=N.createEvent({name:`${R}.close`,sid:P.sid?`${P.sid}|close`:void 0}),Y=N.createStore(!1,{name:`${R}.status`,serialize:"ignore"}).on(F,()=>!0).on(J,()=>!1),K=N.createStore(S,{name:`${R}.state`,sid:P.sid}).on(W,(z,B)=>B).on(F,(z,B)=>B).reset(J);if(f){const{hooks:z}=f;N.launch({target:[z.store,z.store,z.event,z.event,z.event],params:[Y,K,F,J,W]})}return j.open=F,j.close=J,j.status=Y,j.state=K,j.set=W,X(`Gate:${R}`,j)})(nt(ae,m)),u.createStoreConsumer=m=>(Me("createStoreConsumer","useUnit"),ie(m,({children:f},S)=>f(S))),u.useEvent=(m,f)=>((S,h)=>{if(Le(1,"useEvent","useUnit"),!h)return S;const O=N.is.unit(S)||typeof S!="object"?{event:S}:S;return U.default.useMemo(()=>{if(N.is.unit(S))return N.scopeBind(S,{scope:h});const _=Array.isArray(S)?[]:{};for(const j in S)_[j]=N.scopeBind(S[j],{scope:h});return _},[h,...Object.keys(O),...Object.values(O)])})(m,Z(f==null?void 0:f.forceScope)),u.useGate=(m,f={},S)=>ae(m,f,Z(S==null?void 0:S.forceScope)),u.useList=(m,f,S)=>((h,O,_)=>{let j,P,R,W=[];typeof O=="object"&&O!==null?(O.keys&&(W=O.keys),{fn:j,getKey:P,placeholder:R}=O):j=O,N.is.store(h)||de("expect useList first argument to be a store"),typeof j!="function"&&de("expect useList's renderItem to be a function"),Array.isArray(W)||de("expect useList's keys to be an array");const F=U.default.useMemo(()=>{const K=X(`${h.shortName||"Unknown"}.Item`,z=>{const{index:B,keys:ce,keyVal:D,value:re}=z;if(J.current[1])return J.current[0](re,D);const le=ke([{store:h,keys:[B,...ce],fn:(ne,Ze)=>ne[Ze[0]]}],_);return J.current[0](le,B)});return U.default.memo(K)},[h,_,!!P]),J=U.default.useRef([j,P]);J.current=[j,P];const Y=U.default.useMemo(()=>W,W);if(P){const K=ue(h,_);return K.length===0&&R?R:K.map(z=>{const B=J.current[1](z);return U.default.createElement(F,{keyVal:B,key:B,keys:Y,value:z})})}{const K=ke([{store:h,keys:[h],fn:z=>z.length}],_);return K===0&&R?R:Array.from({length:K},(z,B)=>U.default.createElement(F,{index:B,key:B,keys:Y}))}})(m,f,Z(S==null?void 0:S.forceScope)),u.useProvidedScope=()=>Z()||null,u.useStore=Ee,u.useStoreMap=(m,f)=>ke([m,f],Z(m==null?void 0:m.forceScope)),u.useUnit=(m,f)=>ue(m,Z(f==null?void 0:f.forceScope)),Object.defineProperty(u,"__esModule",{value:1})})}(et,et.exports)),et.exports}var pn=dn();const fn=({points:v,button_text:b,title:u="Больше о Вас в полном отчете"})=>{const[V]=pn.useUnit([Lr.$matches]);return A.jsxs(Lt,{className:Ye.wrapper,children:[A.jsxs(pr,{wrap:"nowrap",gap:"xs",className:Ye.top,children:[A.jsx(sr,{w:"3xl",h:"3xl",src:"/images/lock.webp"}),A.jsx("h3",{children:u})]}),A.jsx(sr,{className:Ye.paywallMan,src:`/images/paywall-man${V?"_large":""}.webp`}),A.jsx(Yr,{className:Ye.points,points:v}),A.jsx(Lt,{className:Ye.actions,children:A.jsx(Br,{size:"lg",radius:"md",color:"dark.6",component:"a",href:"/purchase",children:b})})]})};export{an as c};
