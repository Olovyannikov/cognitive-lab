import{w as y,O as $,k,A as N,V as I,r as L,j as t,l as S,F as Q,S as A,T as h,B as E,h as G,m as q,n as _,p as D,q as R,v as U,s as V,t as Y,x as j,y as B,z as m,E as H,G as J}from"./chunk-B324kPJu.js";import{l as K}from"./chunk-BP11TB-b.js";import{M as W}from"./chunk-D1wcBBNI.js";import{s}from"./chunk-BvjKq-Jn.js";import{G as X}from"./chunk-CPRymw13.js";import{C as Z}from"./chunk-DyOzhx-U.js";import{I as ee}from"./chunk-CYQBVyjj.js";import"./chunk-DjYNPCxD.js";import{c as ae}from"./chunk-eFJ95Ac0.js";const c=y({sid:"8wrxdv",fn:()=>$({initialData:{},effect:k(e=>({url:N.BLOG_POSTS,params:{post_type:"post",page_size:Number(e.page_size),...e}})),mapData:e=>{var r;if(!e.result)return{};const a=(r=e.result)==null?void 0:r.payload.toSorted((o,i)=>Number(i.pinned)-Number(o.pinned));return{...e.result,payload:a}}}),name:"getBlogPostsQuery",method:"createQuery"}),xe=y({sid:"fv08ym",fn:()=>$({effect:k(e=>({url:N.BLOG_POST_BY_ID(e)}))}),name:"getBlogPostByIdQuery",method:"createQuery"});y({sid:"pod8va",fn:()=>I(c),name:"none",method:"cache"});const te=L.memo(({post:e})=>t.jsx(X.Col,{span:{base:12,lg:e.pinned?12:4},className:S(e.pinned&&s.pinned),children:t.jsx(Z,{h:"100%",withBorder:!0,component:"a",href:`/blog/${e.id}`,children:t.jsxs(Q,{className:S(s.card,e.pinned&&s.row),gap:"md",children:[t.jsx(ee,{className:s.image,fit:"cover",radius:"xs",src:e.thumbnail_image,alt:e.title}),t.jsxs(A,{className:s.preview,justify:"center",children:[t.jsx(h,{className:s.title,children:e.title}),t.jsx(E,{className:s.text,children:t.jsx(W,{options:{overrides:{h1:a=>t.jsx(h,{order:1,className:s.title,children:a.children}),h2:a=>t.jsx(h,{order:2,className:s.title,children:a.children}),p:a=>t.jsx(G,{className:s.text,children:a.children})}},children:e.body.data})}),t.jsx(q,{variant:"subtle",rightSection:t.jsx(K,{}),className:s.more,children:"Читать"})]})]})})}));te.displayName="BlogPostCard";const p=_(1,{name:"$currentPage",sid:"-bolm2d"}),w=D({name:"pageChanged",sid:"-ygriqc"}),u=_(5,{name:"$pageSize",sid:"2rc1w9"}),re=R(c.finished.success.map(e=>e.result.total_pages),1,{name:"$totalPages",sid:"suv65s"}),se=U(async()=>{await V("/blog?page=1")},{name:"redirectToMainBlogPostPageFx",sid:"-vd63xm"});Y({clock:[j.matched,B.matched],source:{isDesktop:j.$matches,isMobile:B.$matches},target:{$currentPage:p,$pageSize:u},fn:(e,{isDesktop:a,isMobile:r})=>{e.$currentPage(1),console.log({isDesktop:a,isMobile:r}),a&&e.$pageSize(10),r&&e.$pageSize(5)}});m({and:[{clock:w,target:p}],or:{sid:"-ubiyhz"}});m({and:[{clock:u,fn:e=>({page:1,page_size:e}),target:c.refresh}],or:{sid:"-tx8b2l"}});m({and:[{clock:p,source:{page_size:u},fn:({page_size:e},a)=>({page:a,page_size:e}),target:c.refresh}],or:{sid:"-ttxjif"}});m({and:[{clock:c.finished.failure,target:se}],or:{sid:"-tdfppl"}});const T={$currentPage:p,$pageSize:u,pageChanged:w,$totalPages:re};var f,l,oe=Symbol(),d=new Map,ie=e=>location.pathname+(e+""?"?"+e:"")+(location.hash&&location.hash!=="#"?location.hash:""),ne=(e,a)=>history.pushState(a?null:history.state,"",ie(e));function z(e,a){if(l=void 0,d.size){var r=new URLSearchParams(location.search);for(var[o,i]of d.entries())i!=null?r.set(o,`${i}`):r.delete(o);d.clear(),e(r,a==="erase")}}function C(e){return typeof history<"u"&&typeof location<"u"?function({method:a=ne,state:r,serialize:o,deserialize:i,def:O=null,timeout:g}){var v=(P,F)=>(typeof addEventListener<"u"&&addEventListener("popstate",()=>setTimeout(F,0)),{get(){var n=new URLSearchParams(location.search).get(P);return n?i?i(n):n:O},set(n){if(d.set(P,o?o(n):n),g===void 0)return clearTimeout(f),z(a,r);var b=Date.now()+g;(l===void 0||l>b)&&(clearTimeout(f),l=b,f=setTimeout(z,g,a,r))}});return v.keyArea=oe,v}({...e}):J({keyArea:"query"})}function ce(e){return a=>H({adapter:C,...e,...a})}C.factory=!0;var M=ce();const x=ae();M({key:"page_size",pickup:x,store:T.$pageSize,deserialize:e=>Number(e)});M({key:"page",pickup:x,store:T.$currentPage,deserialize:e=>Number(e)});const ve=Object.freeze(Object.defineProperty({__proto__:null,pageStarted:x},Symbol.toStringTag,{value:"Module"}));export{T as B,te as a,xe as b,c as g,ve as i};
