import{X as g,aq as b,bo as j,bp as T,bq as O,w as k,O as q,k as A,aO as H,aP as S,H as E,F as x,I as m,J as C,aQ as N,s as d}from"./chunk-CgydoBgd.js";import"./chunk-CBcHMlJv.js";import{i as R}from"./chunk-DGI3hcLu.js";var V=Array.isArray;function Q(t){return function(a){const{stores:s,events:r,data:u,functions:o}=$(a.bind),f=$(a.hooks||{});return g.forwardRef((e,n)=>{const l=t.useUnit(s,a.useUnitConfig),i=t.useUnit(r,a.useUnitConfig),h=U(o),w={};n&&(w.ref=n);const y=Object.assign(w,l,i,u,h,e),F=t.useUnit(f.events,a.useUnitConfig),P=U(f.functions);return g.useEffect(()=>{const v=Object.assign({},P,F);return v.mounted&&v.mounted(y),()=>{v.unmounted&&v.unmounted(y)}},[F,P]),g.createElement(a.view,y)})}}function $(t){const c={},a={},s={},r={};for(const u in t){const o=t[u];b.event(o)||b.effect(o)?c[u]=o:b.store(o)?a[u]=o:typeof o=="function"?r[u]=o:s[u]=o}return{events:c,stores:a,data:s,functions:r}}function U(t){const c=j();return g.useMemo(()=>{const a={};for(const s in t){const r=t[s];a[s]=T(r,{scope:c||void 0,safe:!0})}return a},[c,t])}const M=()=>null;function _(t){const c=Q(t);return function(s){let r,u,o;"if"in s?(r=s.if.map(n=>n?"then":"else"),u={then:s.then,else:s.else},o=M):(r=s.source,u=s.cases,o=s.default??M);function f(n){const l=t.useUnit(r,s.useUnitConfig),i=u[l]??o;return g.createElement(i,n)}const e=s.bind??{};return c({bind:e,view:f,hooks:s.hooks,useUnitConfig:s.useUnitConfig})}}const B=Q(O),J=_(O),p=k({sid:"-iugphm",fn:()=>q({effect:A(()=>({url:"/surveys/questions"}))}),name:"getQuestionsQuery",method:"createQuery"}),X=k({sid:"-ee19bn",fn:()=>H({effect:S(t=>({url:"/surveys/answers/submit",method:E.POST,body:t}))}),name:"submitAnswersMutation",method:"createMutation"}),G=x(()=>{const t=m(1,{name:"$currentPage",sid:"-ro4v45"}),c=m(0,{name:"$currentProgress",sid:"hhhl88"}),a=m(null,{name:"$currentQuestion",sid:"-nkasqq"}),s=m(null,{name:"$currentValue",sid:"-o0im1t"}),r=m({answers:[]},{name:"$scaleForm",sid:"sjuosy"}),u=C({name:"scaleFormFieldChanged",sid:"cmq463"}),o=C({name:"formPageChanged",sid:"-11v8w4"}),f=k({sid:"-gydwjl",fn:()=>N(u,250),name:"delayedFormFieldChanged",method:"delay"});return d({and:[{clock:[t,p.$data],source:{page:t,questions:p.$data},fn:({page:e,questions:n})=>n?n[e-1]:null,target:a}],or:{sid:"sjbbmu"}}),d({and:[{clock:u,source:r,fn:(e,n)=>(e.answers[n.index]=n,{...e}),target:r}],or:{sid:"t20bt4"}}),d({and:[{clock:f,source:t,filter:(e,n)=>!(n.isMultiple||n.isSingle),fn:e=>e+1,target:o}],or:{sid:"tj1y7b"}}),d({and:[{clock:u,source:{form:r,page:t},filter:(e,n)=>!(n.isMultiple||n.isSingle),fn:({form:e,page:n})=>{const l=n-1;return e.answers&&e.answers.length>0&&"value"in e.answers[l].answer&&e.answers[l].answer.value?e.answers[l].answer.value:null},target:s}],or:{sid:"tyzzes"}}),d({and:[{clock:[r,o],source:{form:r,page:t},fn:({form:{answers:e},page:n},l)=>{var h;const i=(R(l)?l:n)-1;return(h=e[i])!=null&&h.answer?e&&e[i].answer&&V(e[i].answer)||e&&e.length>0&&e[i].isSingle?e[i].answer:e&&e.length>0&&"value"in e[i].answer?e[i].answer.value:null:null},target:s}],or:{sid:"uwjflt"}}),d({and:[{clock:o,fn:e=>(window.scrollTo(0,0),e),target:t}],or:{sid:"eus4mk"}}),d({and:[{clock:r,source:{questions:p.$data,form:r},fn:({questions:e,form:{answers:n}})=>Number((n.length/((e==null?void 0:e.length)??0)*100).toFixed(0)),target:c}],or:{sid:"fb9yfe"}}),{$currentPage:t,$currentProgress:c,$currentQuestion:a,$currentValue:s,$scaleForm:r,scaleFormFieldChanged:u,formPageChanged:o}});export{G as T,p as g,V as i,B as r,X as s,J as v};
