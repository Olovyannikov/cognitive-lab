import{W as x,bd as b,Y as p,Z as f,_ as h,$ as g,a2 as F,a3 as j,a4 as k,M as r,be as w,bf as v,x as S,e as n,u as T,a6 as E,j as a,F as I,h as R,bg as M,aG as N,A as P,V as z,bh as B}from"./chunk-CEgQvrcO.js";import{d as O}from"./chunk-CQXaNoVx.js";import{I as _}from"./chunk-DJQzIxIL.js";import{s as m}from"./chunk-Cwmt49qL.js";const i=x({sid:"-s4ky2h",fn:()=>b({effect:p(({user_report_id:e,...o})=>({url:h.surveys.email(e),method:f.POST,body:o}))}),name:"sendFreeReportOnEmailMutation",method:"createMutation"}),L=g(()=>{const e=F({name:"submitForm",sid:"-261mp6"}),o=j(s=>{k.show({title:"Отчет отправлен!",message:`Отчет отправлен на почту ${s}`})},{name:"showUserEmailNotificationFx",sid:"82dtwb"});return r({and:[{clock:e,target:i.start}],or:{sid:"-fgmro9"}}),r({and:[{clock:i.finished.success,filter:({params:s})=>!!s.email,fn:({params:{email:s}})=>s,target:o}],or:{sid:"-f2c48v"}}),{submitForm:e}}),A=w({email:v().min(1,{message:"Обязательное поле"}).email("Введите почту в формате example@mail.org")}),W=({type:e="text"})=>{const o=S(),{pending:s}=n(i),[l]=n([L.submitForm]),{routeParams:{reportId:d}}=T(),t=E({mode:"controlled",initialValues:{email:"",user_report_id:d??""},validate:B(A)}),c=t.onSubmit(u=>{l(u)});return a.jsx(_,{className:e==="block"?m.container:"",children:a.jsx("form",{onSubmit:c,children:a.jsxs(I,{className:m.wrapper,children:[e==="text"&&a.jsx(R,{fw:"bold",visibleFrom:"md",fz:24,children:"Отправьте отчет на почту"}),a.jsx(M,{active:!!t.errors.email,children:a.jsx(N,{inputMode:"email",disabled:s,placeholder:"name@mail.ru",miw:o?380:"100%",ml:e==="text"?"auto":0,size:e==="block"?"lg":"md",bg:e==="block"?"violet.0":"white",...t.getInputProps("email")},t.key("email"))}),a.jsx(P,{type:"submit",loading:s,fullWidth:!o,disabled:s,size:e==="block"?"lg":"md",leftSection:a.jsx(O,{size:20}),variant:e==="block"?void 0:"default",c:e==="block"&&!s?"white":"dark.7",px:"md",children:o?"Отправить":"Отправить отчет на почту"}),a.jsx(z,{px:"md",children:"Купить полный отчёт"})]})})})};export{W as S};
