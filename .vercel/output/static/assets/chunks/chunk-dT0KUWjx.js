import{a0 as g,ar as y,bn as T,bo as x,bp as O,w as k,O as A,k as E,aE as S,aF as j,W as H,n as N,p as m,q as C,aG as R,z as d}from"./chunk-D4HLANBA.js";import"./chunk-CqOiLJi4.js";import{i as V}from"./chunk-DGI3hcLu.js";var _=Array.isArray;function Q(t){return function(a){const{stores:s,events:r,data:u,functions:o}=$(a.bind),f=$(a.hooks||{});return g.forwardRef((e,n)=>{const l=t.useUnit(s,a.useUnitConfig),i=t.useUnit(r,a.useUnitConfig),h=U(o),w={};n&&(w.ref=n);const p=Object.assign(w,l,i,u,h,e),b=t.useUnit(f.events,a.useUnitConfig),P=U(f.functions);return g.useEffect(()=>{const v=Object.assign({},P,b);return v.mounted&&v.mounted(p),()=>{v.unmounted&&v.unmounted(p)}},[b,P]),g.createElement(a.view,p)})}}function $(t){const c={},a={},s={},r={};for(const u in t){const o=t[u];y.event(o)||y.effect(o)?c[u]=o:y.store(o)?a[u]=o:typeof o=="function"?r[u]=o:s[u]=o}return{events:c,stores:a,data:s,functions:r}}function U(t){const c=T();return g.useMemo(()=>{const a={};for(const s in t){const r=t[s];a[s]=x(r,{scope:c||void 0,safe:!0})}return a},[c,t])}const M=()=>null;function q(t){const c=Q(t);return function(s){let r,u,o;"if"in s?(r=s.if.map(n=>n?"then":"else"),u={then:s.then,else:s.else},o=M):(r=s.source,u=s.cases,o=s.default??M);function f(n){const l=t.useUnit(r,s.useUnitConfig),i=u[l]??o;return g.createElement(i,n)}const e=s.bind??{};return c({bind:e,view:f,hooks:s.hooks,useUnitConfig:s.useUnitConfig})}}const G=Q(O),I=q(O),F=k({sid:"-iugphm",fn:()=>A({effect:E(()=>({url:"/surveys/questions"}))}),name:"getQuestionsQuery",method:"createQuery"}),W=k({sid:"-ee19bn",fn:()=>S({effect:j(t=>({url:"/surveys/answers/submit",method:H.POST,body:t}))}),name:"submitAnswersMutation",method:"createMutation"}),J=N(()=>{const t=m(1,{name:"$currentPage",sid:"-s56hic"}),c=m(0,{name:"$currentProgress",sid:"h0fyu1"}),a=m(null,{name:"$currentQuestion",sid:"-o1cf4x"}),s=m(null,{name:"$currentValue",sid:"-ohk8g0"}),r=m({answers:[]},{name:"$scaleForm",sid:"s2t2er"}),u=C({name:"scaleFormFieldChanged",sid:"c5ohrw"}),o=C({name:"formPageChanged",sid:"-1iwvab"}),f=k({sid:"-hffixs",fn:()=>R(u,250),name:"delayedFormFieldChanged",method:"delay"});return d({and:[{clock:[t,F.$data],source:{page:t,questions:F.$data},fn:({page:e,questions:n})=>n?n[e-1]:null,target:a}],or:{sid:"sirj1h"}}),d({and:[{clock:u,source:r,fn:(e,n)=>(e.answers[n.index]=n,{...e}),target:r}],or:{sid:"t1gj7r"}}),d({and:[{clock:f,source:t,filter:(e,n)=>!(n.isMultiple||n.isSingle),fn:e=>e+1,target:o}],or:{sid:"tii5ly"}}),d({and:[{clock:u,source:{form:r,page:t},filter:(e,n)=>!(n.isMultiple||n.isSingle),fn:({form:e,page:n})=>{const l=n-1;return e.answers&&e.answers.length>0&&"value"in e.answers[l].answer&&e.answers[l].answer.value?e.answers[l].answer.value:null},target:s}],or:{sid:"tyg6tf"}}),d({and:[{clock:[r,o],source:{form:r,page:t},fn:({form:{answers:e},page:n},l)=>{var h;const i=(V(l)?l:n)-1;return(h=e[i])!=null&&h.answer?e&&e[i].answer&&_(e[i].answer)||e&&e.length>0&&e[i].isSingle?e[i].answer:e&&e.length>0&&"value"in e[i].answer?e[i].answer.value:null:null},target:s}],or:{sid:"uvzn0g"}}),d({and:[{clock:o,fn:e=>(window.scrollTo(0,0),e),target:t}],or:{sid:"eu8c17"}}),d({and:[{clock:r,source:{questions:F.$data,form:r},fn:({questions:e,form:{answers:n}})=>Number((n.length/((e==null?void 0:e.length)??0)*100).toFixed(0)),target:c}],or:{sid:"faq5u1"}}),{$currentPage:t,$currentProgress:c,$currentQuestion:a,$currentValue:s,$scaleForm:r,scaleFormFieldChanged:u,formPageChanged:o}});export{J as T,F as g,_ as i,G as r,W as s,I as v};
