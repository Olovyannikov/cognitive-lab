import{w as m,O as g,k as u,A as h,V as b,s as j,j as s,y as f,a0 as _,S as N,T as p,B as k,h as S,v,F as z,I as x,J as $,t as d,am as w,an as y,ai as B,ao as Q,K as C,x as D}from"./chunk-vBsGuFdY.js";import"./chunk-Bu2vhmlo.js";import{l as O}from"./chunk-DLeu19Z8.js";import{M as T}from"./chunk-Bf5h2jrR.js";import{s as r}from"./chunk-9Of7RetC.js";import{G as I}from"./chunk-BokkyaSS.js";import{C as M}from"./chunk-DKI5DNF8.js";import{I as F}from"./chunk-CPj4n_w_.js";import{B as A}from"./chunk-BKSRHl2T.js";const c=m({sid:"8wrxdv",fn:()=>g({initialData:{},effect:u(e=>({url:h.BLOG_POSTS,params:{post_type:"post",page_size:Number(e.page_size),...e}})),mapData:e=>{var o;if(!e.result)return{};const a=(o=e.result)==null?void 0:o.payload.toSorted((i,n)=>Number(n.pinned)-Number(i.pinned));return{...e.result,payload:a}}}),name:"getBlogPostsQuery",method:"createQuery"}),H=m({sid:"-1szoee",fn:()=>g({initialData:{},effect:u(e=>({url:h.BLOG_POSTS,params:{post_type:"post",page_size:Number(e.page_size),show_on_main:!0,...e}})),mapData:e=>{var o;if(!e.result)return{};const a=(o=e.result)==null?void 0:o.payload.toSorted((i,n)=>Number(n.pinned)-Number(i.pinned)).map(i=>({...i,updated_at:new Date(i.updated_at).toLocaleDateString("ru-RU")}));return{...e.result,payload:a}}}),name:"getAllBlogPostsQuery",method:"createQuery"}),W=m({sid:"-ck1tj0",fn:()=>g({effect:u(e=>({url:h.BLOG_POST_BY_ID(e)}))}),name:"getBlogPostByIdQuery",method:"createQuery"});m({sid:"r1uq9s",fn:()=>b(c),name:"none",method:"cache"});const G=j.memo(({post:e})=>s.jsx(I.Col,{span:{base:12,lg:e.pinned?12:4},className:f(e.pinned&&r.pinned),children:s.jsx(M,{h:"100%",withBorder:!0,component:"a",href:`/blog/${e.id}`,children:s.jsxs(_,{className:f(r.card,e.pinned&&r.row),gap:"md",children:[s.jsx(F,{className:r.image,fit:"cover",radius:"xs",src:e.thumbnail_image,alt:e.title}),s.jsxs(N,{className:r.preview,justify:"center",children:[s.jsx(p,{className:r.title,children:e.title}),s.jsx(k,{className:r.text,children:s.jsx(T,{options:{overrides:{h1:a=>s.jsx(p,{order:1,className:r.title,children:a.children}),h2:a=>s.jsx(p,{order:2,className:r.title,children:a.children}),p:a=>s.jsx(S,{className:r.text,children:a.children}),blockquote:a=>s.jsx(A,{mb:"md",py:"sm",px:"md",color:"violet.9",bg:"transparent",icon:null,children:a.children})}},children:e.body.data})}),s.jsx(v,{variant:"subtle",rightSection:s.jsx(O,{}),className:r.more,children:"Читать"})]})]})})}));G.displayName="BlogPostCard";const X=z(()=>{const e=x(1,{name:"$currentPage",sid:"ytwjf1"}),a=$({name:"pageChanged",sid:"oolbf0"});d({and:[{clock:a,target:e}],or:{sid:"-vsuzyk"}});const o=x(5,{name:"$pageSize",sid:"62nf95"});d({and:[{clock:o,filter:c.$data.map(t=>{var l;return((l=t==null?void 0:t.payload)==null?void 0:l.length)<1}),fn:t=>({page:1,page_size:t}),target:c.refresh}],or:{sid:"-vpk8ee"}}),d({and:[{clock:e,source:{page_size:o},fn:({page_size:t},l)=>({page:l,page_size:t}),target:c.refresh}],or:{sid:"-vapsdn"}}),w({clock:[B.matched,y.matched],source:{isDesktop:B.$matches,isMobile:y.$matches},target:{$currentPage:e,$pageSize:o},fn:(t,{isDesktop:l,isMobile:P})=>{t.$currentPage(1),l&&t.$pageSize(10),P&&t.$pageSize(5)}});const i=Q(c.finished.success.map(t=>t.result.total_pages),1,{name:"$totalPages",sid:"h0dvkf"}),n=C(async()=>{await D("/blog?page=1")},{name:"redirectToMainBlogPostPageFx",sid:"rtgny8"});return d({and:[{clock:c.finished.failure,target:n}],or:{sid:"-tfmvzl"}}),{$currentPage:e,$pageSize:o,pageChanged:a,$totalPages:i,redirectToMainBlogPostPageFx:n}});export{X as B,G as a,W as b,H as c,c as g};
