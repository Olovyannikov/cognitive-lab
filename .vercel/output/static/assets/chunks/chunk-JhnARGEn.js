import{w as m,O as u,k as h,A as f,V as j,s as _,j as s,y,a2 as N,I as k,S,T as g,B as $,h as z,v,G as w,K as p,L as Q,t as d,aq as q,ar as B,am as P,as as C,N as D,x as O}from"./chunk-C7m8DYzD.js";import"./chunk-Dwlwt0c9.js";import{l as T}from"./chunk-BizIpkoX.js";import{M}from"./chunk-D-QlnY7g.js";import{s as o}from"./chunk-9Of7RetC.js";import{G as F}from"./chunk-CMnQn_qa.js";import{C as G}from"./chunk-C-Lyo2Xr.js";import{B as I}from"./chunk-B0tMDIza.js";const n=m({sid:"8wrxdv",fn:()=>u({initialData:{},effect:h(e=>({url:f.BLOG_POSTS,params:{post_type:"post",page_size:Number(e.page_size),...e}})),mapData:e=>{var i;if(!e.result)return{};const a=(i=e.result)==null?void 0:i.payload.toSorted((r,c)=>Number(c.pinned)-Number(r.pinned));return{...e.result,payload:a}}}),name:"getBlogPostsQuery",method:"createQuery"}),J=m({sid:"-1szoee",fn:()=>u({initialData:{},effect:h(e=>({url:f.BLOG_POSTS,params:{post_type:"post",page_size:Number(e.page_size),show_on_main:!0,...e}})),mapData:e=>{var i;if(!e.result)return{};const a=(i=e.result)==null?void 0:i.payload.toSorted((r,c)=>Number(c.pinned)-Number(r.pinned)).map(r=>({...r,updated_at:new Date(r.updated_at).toLocaleDateString("ru-RU")}));return{...e.result,payload:a}}}),name:"getAllBlogPostsQuery",method:"createQuery"}),W=m({sid:"-ck1tj0",fn:()=>u({effect:h(e=>({url:f.BLOG_POST_BY_ID(e)}))}),name:"getBlogPostByIdQuery",method:"createQuery"});m({sid:"r1uq9s",fn:()=>j(n),name:"none",method:"cache"});const A=_.memo(({post:e})=>s.jsx(F.Col,{span:{base:12,lg:e.pinned?12:4},className:y(e.pinned&&o.pinned),children:s.jsx(G,{h:"100%",withBorder:!0,component:"a",href:`/blog/${e.id}`,children:s.jsxs(N,{className:y(o.card,e.pinned&&o.row),gap:"md",children:[s.jsx(k,{className:o.image,fit:"cover",radius:"xs",src:e.thumbnail_image,alt:e.title}),s.jsxs(S,{className:o.preview,justify:"center",children:[s.jsx(g,{className:o.title,children:e.title}),s.jsx($,{className:o.text,children:s.jsx(M,{options:{overrides:{h1:a=>s.jsx(g,{order:1,className:o.title,children:a.children}),h2:a=>s.jsx(g,{order:2,className:o.title,children:a.children}),p:a=>s.jsx(z,{className:o.text,children:a.children}),blockquote:a=>s.jsx(I,{mb:"md",py:"sm",px:"md",color:"violet.9",bg:"transparent",icon:null,children:a.children}),a:a=>s.jsx(s.Fragment,{children:a.children})}},children:e.body.data})}),s.jsx(v,{variant:"subtle",rightSection:s.jsx(T,{}),className:o.more,children:"Читать"})]})]})})}));A.displayName="BlogPostCard";const X=w(()=>{const e=p(1,{name:"$currentPage",sid:"zay5t8"}),a=Q({name:"pageChanged",sid:"p5mxt7"}),i=p([],{name:"$blogPosts",sid:"-ue9snx"});d({and:[{clock:n.finished.success,fn:({result:t})=>t.payload,target:i}],or:{sid:"-vr7m6h"}}),d({and:[{clock:a,target:e}],or:{sid:"-vcd65q"}});const r=p(5,{name:"$pageSize",sid:"ka032z"});d({and:[{clock:r,filter:n.$data.map(t=>{var l;return((l=t==null?void 0:t.payload)==null?void 0:l.length)<1}),fn:t=>({page:1,page_size:t}),target:n.refresh}],or:{sid:"-v92elk"}}),d({and:[{clock:e,source:{page_size:r},fn:({page_size:t},l)=>({page:l,page_size:t}),target:n.refresh}],or:{sid:"-uu7ykt"}}),q({clock:[P.matched,B.matched],source:{isDesktop:P.$matches,isMobile:B.$matches},target:{$currentPage:e,$pageSize:r},fn:(t,{isDesktop:l,isMobile:b})=>{t.$currentPage(1),l&&t.$pageSize(10),b&&t.$pageSize(5)}});const c=C(n.finished.success.map(t=>t.result.total_pages),1,{name:"$totalPages",sid:"v7qje9"}),x=D(async()=>{await O("/blog?page=1")},{name:"redirectToMainBlogPostPageFx",sid:"-t0aq72"});return d({and:[{clock:n.finished.failure,target:x}],or:{sid:"-sz526r"}}),{$currentPage:e,$pageSize:r,pageChanged:a,$totalPages:c,redirectToMainBlogPostPageFx:x,$blogPosts:i}});export{X as B,A as a,W as b,J as c,n as g};
